{
  "id" : "manual_test__loan_repayment_type_logic",
  "metainfo" : {
    "label" : "manual_test__loan_repayment_type_logic",
    "autoLayout" : true,
    "staleState" : "none",
    "sourceSuggestions" : {
      "sources" : [ ]
    },
    "graphConfig" : {
      "entityConfig" : {
        "materialized" : "ephemeral",
        "database" : "\"main\"",
        "schema" : "\"default\"",
        "type" : "ModelConfig"
      }
    },
    "version" : 3
  },
  "processes" : {
    "refs_repay_type_##rzMGhEjo" : {
      "id" : "refs_repay_type_##rzMGhEjo",
      "component" : "Source",
      "metadata" : {
        "label" : "refs_repay_type_map",
        "x" : -1260,
        "y" : 140,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "refs_repay_type_map",
          "sourceName" : "westpac_efs",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "kpUUxC89",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "mu001_product_co##RTfylfxA" : {
      "id" : "mu001_product_co##RTfylfxA",
      "component" : "Reformat",
      "metadata" : {
        "label" : "mu001_product_code_mapping",
        "x" : -120,
        "y" : 1040,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "Armt_Key"
          },
          "alias" : "ARMT_KEY",
          "_row_id" : "1667165412"
        }, {
          "expression" : {
            "expression" : "'MU-001'"
          },
          "alias" : "SRC_SYS_CODE",
          "_row_id" : "1633743303"
        }, {
          "expression" : {
            "expression" : "''"
          },
          "alias" : "SRC_REPAY_TYPE_CODE",
          "_row_id" : "1063010981"
        }, {
          "expression" : {
            "expression" : "'Product_Code'"
          },
          "alias" : "SRC_COLUMN",
          "_row_id" : "1729114613"
        }, {
          "expression" : {
            "expression" : "Product_Code"
          },
          "alias" : "MU001_PRODUCT_CODE",
          "_row_id" : "2077114885"
        }, {
          "expression" : {
            "expression" : "System_Product_Type"
          },
          "alias" : "MU001_SYSTEM_PRODUCT_TYPE",
          "_row_id" : "1927402287"
        }, {
          "expression" : {
            "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd')"
          },
          "alias" : "PROCESS_DATE",
          "_row_id" : "1534589438"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "igkZgIDn",
          "slug" : "mb_accounts_filtered"
        } ],
        "outputs" : [ {
          "id" : "SExlNsH4",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "filtered_source_##hyAg44j6" : {
      "id" : "filtered_source_##hyAg44j6",
      "component" : "Filter",
      "metadata" : {
        "label" : "filtered_source_data",
        "x" : -280,
        "y" : -220,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zsgd_From_Date AND zsgd_To_Date\nAND zsgd_Src_Sys_Code IN ('LIS', 'DDA', 'CHA', 'LNS', 'CHS')"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "kRe5DQJs",
          "slug" : "source_repay_type_data"
        } ],
        "outputs" : [ {
          "id" : "J7HwAxgy",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "account_loan_pro##zmMtzv3e" : {
      "id" : "account_loan_pro##zmMtzv3e",
      "component" : "Join",
      "metadata" : {
        "label" : "account_loan_product_join",
        "x" : -520,
        "y" : 1040,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "zwgd_mrtg_loan_m_hist",
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.Account_Id = zwgd_mrtg_loan_m_hist.Account_Id\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zwgd_mrtg_loan_m_hist.From_Date AND zwgd_mrtg_loan_m_hist.To_Date"
          },
          "joinType" : "LEFT"
        } ],
        "expressions" : [ {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.Armt_Key"
          },
          "_row_id" : "1057585038"
        }, {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.Source_System_Code"
          },
          "_row_id" : "1128584397"
        }, {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.From_Date"
          },
          "_row_id" : "1407087979"
        }, {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.To_Date"
          },
          "_row_id" : "507059979"
        }, {
          "expression" : {
            "expression" : "zwgd_mrtg_loan_m_hist.Product_Code"
          },
          "_row_id" : "545205751"
        }, {
          "expression" : {
            "expression" : "zwgd_mrtg_loan_m_hist.System_Product_Type"
          },
          "_row_id" : "481356702"
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "headAlias" : "zwgd_all_acct_m_hist"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "QSpJLhmn",
          "slug" : "zwgd_all_acct_m_hist"
        }, {
          "id" : "kmJLAjlb",
          "slug" : "zwgd_mrtg_loan_m_hist"
        } ],
        "outputs" : [ {
          "id" : "ENzDYR7d",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "znex_loan##YcJxwoeo" : {
      "id" : "znex_loan##YcJxwoeo",
      "component" : "Source",
      "metadata" : {
        "label" : "znex_loan",
        "x" : -720,
        "y" : 740,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "znex_loan",
          "sourceName" : "westpac_sgdw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "vWIJiqft",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "source_repay_typ##Qc3eFU5e" : {
      "id" : "source_repay_typ##Qc3eFU5e",
      "component" : "Join",
      "metadata" : {
        "label" : "source_repay_type_data",
        "x" : -480,
        "y" : -220,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "zsgd_al",
          "expression" : {
            "expression" : "zsgd.Acct_Key = zsgd_al.Acct_Key\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zsgd_al.From_Date AND zsgd_al.To_Date"
          },
          "joinType" : "LEFT"
        }, {
          "alias" : "zsgd_a",
          "expression" : {
            "expression" : "zsgd.Acct_Key = zsgd_a.Acct_Key\nAND zsgd.Src_Sys_Code = 'CHS'\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zsgd_a.From_Date AND zsgd_a.To_Date"
          },
          "joinType" : "LEFT"
        } ],
        "expressions" : [ {
          "expression" : {
            "expression" : "zsgd.From_Date"
          },
          "alias" : "zsgd_From_Date",
          "_row_id" : "1193878624"
        }, {
          "expression" : {
            "expression" : "zsgd.To_Date"
          },
          "alias" : "zsgd_To_Date",
          "_row_id" : "1384807285"
        }, {
          "expression" : {
            "expression" : "zsgd.Acct_Key"
          },
          "alias" : "zsgd_Acct_Key",
          "_row_id" : "1772169294"
        }, {
          "expression" : {
            "expression" : "zsgd_al.Acct_Key"
          },
          "alias" : "zsgd_al_Acct_Key",
          "_row_id" : "1906269289"
        }, {
          "expression" : {
            "expression" : "zsgd.Src_Sys_Code"
          },
          "alias" : "zsgd_Src_Sys_Code",
          "_row_id" : "860706653"
        }, {
          "expression" : {
            "expression" : "zsgd_al.From_Date"
          },
          "alias" : "zsgd_al_From_Date",
          "_row_id" : "396021523"
        }, {
          "expression" : {
            "expression" : "zsgd_a.From_Date"
          },
          "alias" : "zsgd_a_From_Date",
          "_row_id" : "1886732494"
        }, {
          "expression" : {
            "expression" : "zsgd_al.To_Date"
          },
          "alias" : "zsgd_al_To_Date",
          "_row_id" : "1532102044"
        }, {
          "expression" : {
            "expression" : "zsgd_a.To_Date"
          },
          "alias" : "zsgd_a_To_Date",
          "_row_id" : "102159937"
        }, {
          "expression" : {
            "expression" : "zsgd_al.Repay_Type_Code"
          },
          "alias" : "zsgd_al_Repay_Type_Code",
          "_row_id" : "1959438645"
        }, {
          "expression" : {
            "expression" : "zsgd_a.OD_Type"
          },
          "alias" : "zsgd_a_OD_Type",
          "_row_id" : "2077710681"
        }, {
          "expression" : {
            "expression" : "zsgd.Armt_Key"
          },
          "alias" : "zsgd_Armt_Key",
          "_row_id" : "1355863282"
        }, {
          "expression" : {
            "expression" : "zsgd_a.Acct_Key"
          },
          "alias" : "zsgd_a_Acct_Key",
          "_row_id" : "1650926462"
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "headAlias" : "zsgd"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LdVY1XPW",
          "slug" : "zsgd"
        }, {
          "id" : "TPqOuYOc",
          "slug" : "zsgd_al"
        }, {
          "id" : "kcXw1DHp",
          "slug" : "zsgd_a"
        } ],
        "outputs" : [ {
          "id" : "j5kVG072",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "zsgd_acct_loan##LWHnF8DB" : {
      "id" : "zsgd_acct_loan##LWHnF8DB",
      "component" : "Source",
      "metadata" : {
        "label" : "zsgd_acct_loan",
        "x" : -680,
        "y" : -160,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zsgd_acct_loan",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "nwncvIOV",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "zsgd_acct##f2BGzsBZ" : {
      "id" : "zsgd_acct##f2BGzsBZ",
      "component" : "Source",
      "metadata" : {
        "label" : "zsgd_acct",
        "x" : -700,
        "y" : -380,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zsgd_acct",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "wAsx57n4",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "repay_type_code_##HQPt6sKU" : {
      "id" : "repay_type_code_##HQPt6sKU",
      "component" : "Reformat",
      "metadata" : {
        "label" : "repay_type_code_extract",
        "x" : -120,
        "y" : 680,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "znex_Armt_Key"
          },
          "alias" : "armt_key",
          "_row_id" : "669312433"
        }, {
          "expression" : {
            "expression" : "'ML-005'"
          },
          "alias" : "src_sys_code",
          "_row_id" : "439723426"
        }, {
          "expression" : {
            "expression" : "COALESCE(znex_l_Repay_Type_Code, '')"
          },
          "alias" : "src_repay_type_code",
          "_row_id" : "1178690338"
        }, {
          "expression" : {
            "expression" : "'Repay_Type_Code'"
          },
          "alias" : "src_column",
          "_row_id" : "691891759"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_product_code",
          "_row_id" : "2045326304"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_system_product_type",
          "_row_id" : "410352595"
        }, {
          "expression" : {
            "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd')"
          },
          "alias" : "process_date",
          "_row_id" : "1546401631"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "oJsQYNoc",
          "slug" : "account_date_filter"
        } ],
        "outputs" : [ {
          "id" : "jR4P9JVs",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "znex_account##fuC2GH71" : {
      "id" : "znex_account##fuC2GH71",
      "component" : "Source",
      "metadata" : {
        "label" : "znex_account",
        "x" : -720,
        "y" : 600,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "znex_account",
          "sourceName" : "westpac_sgdw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "zWfb2eoD",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "loan_repayment_type_logic_m7inbLdt" : {
      "id" : "loan_repayment_type_logic_m7inbLdt",
      "component" : "TargetModel",
      "metadata" : {
        "label" : "loan_repayment_type_logic"
      },
      "properties" : {
        "customQueryDisabled" : true,
        "customQuery" : false,
        "incrementalEditorDisabled" : true,
        "query" : "\nSELECT *\n\nFROM loan_repayment_type_logic\n\n",
        "isModel" : true,
        "incrementalKey" : false,
        "incremental" : {
          "expression" : "true"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "input_port_0",
          "slug" : "input_port_0"
        } ],
        "outputs" : [ {
          "id" : "output_port_0",
          "slug" : "output_port_0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "account_loan_joi##LX9FU5ri" : {
      "id" : "account_loan_joi##LX9FU5ri",
      "component" : "Join",
      "metadata" : {
        "label" : "account_loan_joined_data",
        "x" : -520,
        "y" : 680,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "znex_l",
          "expression" : {
            "expression" : "znex.Account_Id = znex_l.Account_Id\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN znex_l.From_Date AND znex_l.To_Date"
          },
          "joinType" : "LEFT"
        } ],
        "expressions" : [ {
          "expression" : {
            "expression" : "znex_l.Account_Id"
          },
          "alias" : "znex_l_Account_Id",
          "_row_id" : "1662246652"
        }, {
          "expression" : {
            "expression" : "znex.Account_Id"
          },
          "alias" : "znex_Account_Id",
          "_row_id" : "548277493"
        }, {
          "expression" : {
            "expression" : "znex_l.From_Date"
          },
          "alias" : "znex_l_From_Date",
          "_row_id" : "229682406"
        }, {
          "expression" : {
            "expression" : "znex.Armt_Key"
          },
          "alias" : "znex_Armt_Key",
          "_row_id" : "772146538"
        }, {
          "expression" : {
            "expression" : "znex_l.Repay_Type_Code"
          },
          "alias" : "znex_l_Repay_Type_Code",
          "_row_id" : "1991845155"
        }, {
          "expression" : {
            "expression" : "znex.From_Date"
          },
          "alias" : "znex_From_Date",
          "_row_id" : "1945165438"
        }, {
          "expression" : {
            "expression" : "znex.To_Date"
          },
          "alias" : "znex_To_Date",
          "_row_id" : "1628624930"
        }, {
          "expression" : {
            "expression" : "znex_l.To_Date"
          },
          "alias" : "znex_l_To_Date",
          "_row_id" : "1984391163"
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "headAlias" : "znex"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "tUT2mW5w",
          "slug" : "znex"
        }, {
          "id" : "oLjlMhzZ",
          "slug" : "znex_l"
        } ],
        "outputs" : [ {
          "id" : "O4mLCoyF",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "zrms_account##hXz7k6cG" : {
      "id" : "zrms_account##hXz7k6cG",
      "component" : "Source",
      "metadata" : {
        "label" : "zrms_account",
        "x" : -720,
        "y" : 420,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zrms_account",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "u88w3yej",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "repay_type_sourc##pf1mpt7P" : {
      "id" : "repay_type_sourc##pf1mpt7P",
      "component" : "Reformat",
      "metadata" : {
        "label" : "repay_type_source_data",
        "x" : -80,
        "y" : -220,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "zsgd_Armt_Key"
          },
          "alias" : "armt_key",
          "_row_id" : "956169596"
        }, {
          "expression" : {
            "expression" : "zsgd_Src_Sys_Code"
          },
          "alias" : "src_sys_code",
          "_row_id" : "2024797990"
        }, {
          "expression" : {
            "expression" : "CASE\n  WHEN zsgd_Src_Sys_Code = 'CHS'\n    THEN COALESCE(zsgd_a_OD_Type, '')\n  ELSE COALESCE(zsgd_al_Repay_Type_Code, '')\nEND"
          },
          "alias" : "src_repay_type_code",
          "_row_id" : "799398720"
        }, {
          "expression" : {
            "expression" : "CASE\n  WHEN zsgd_Src_Sys_Code = 'CHS'\n    THEN 'OD_Type'\n  ELSE 'Repay_Type_Code'\nEND"
          },
          "alias" : "src_column",
          "_row_id" : "1345670162"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_product_code",
          "_row_id" : "1335031587"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_system_product_type",
          "_row_id" : "449952760"
        }, {
          "expression" : {
            "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd')"
          },
          "alias" : "process_date",
          "_row_id" : "1553684295"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "snUL4gxS",
          "slug" : "filtered_source_data"
        } ],
        "outputs" : [ {
          "id" : "KIP34bY3",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "repayment_type_e##IjhgFP6T" : {
      "id" : "repayment_type_e##IjhgFP6T",
      "component" : "Reformat",
      "metadata" : {
        "label" : "repayment_type_extraction",
        "x" : -120,
        "y" : 340,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "zrms_Account_Id"
          },
          "alias" : "armt_key",
          "_row_id" : "61133663"
        }, {
          "expression" : {
            "expression" : "'RMS'"
          },
          "alias" : "src_sys_code",
          "_row_id" : "1363268901"
        }, {
          "expression" : {
            "expression" : "COALESCE(zrms_la_Repayment_Type, '')"
          },
          "alias" : "src_repay_type_code",
          "_row_id" : "355360247"
        }, {
          "expression" : {
            "expression" : "'Repayment_Type'"
          },
          "alias" : "src_column",
          "_row_id" : "1567919363"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_product_code",
          "_row_id" : "1983469699"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_system_product_type",
          "_row_id" : "1271525328"
        }, {
          "expression" : {
            "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd')"
          },
          "alias" : "process_date",
          "_row_id" : "1111629718"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Vu7ex5Ct",
          "slug" : "filtered_active_accounts"
        } ],
        "outputs" : [ {
          "id" : "Hc2y2HdJ",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "ztbk_account##lG10XNK8" : {
      "id" : "ztbk_account##lG10XNK8",
      "component" : "Source",
      "metadata" : {
        "label" : "ztbk_account",
        "x" : -660,
        "y" : 80,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "ztbk_account",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "hJCGZSor",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "zrms_loan_accoun##c4dGP6t6" : {
      "id" : "zrms_loan_accoun##c4dGP6t6",
      "component" : "Source",
      "metadata" : {
        "label" : "zrms_loan_account",
        "x" : -720,
        "y" : 280,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zrms_loan_account",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "reuCrjmd",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "loan_repayment_t##FaKYOccQ" : {
      "id" : "loan_repayment_t##FaKYOccQ",
      "component" : "Join",
      "metadata" : {
        "label" : "loan_repayment_type_logic",
        "x" : -320,
        "y" : 520,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "rrtm",
          "expression" : {
            "expression" : "b.src_sys_code = rrtm.Src_Sys_Code\nAND b.src_repay_type_code = rrtm.Src_Repay_Type_Code\nAND rrtm.Src_Column = 'Repay_Type_Code'\nAND b.process_date BETWEEN rrtm.From_Date AND rrtm.To_Date"
          },
          "joinType" : "LEFT"
        }, {
          "alias" : "rctm",
          "expression" : {
            "expression" : "b.src_sys_code = rctm.Src_Sys_Code\nAND b.src_repay_type_code = rctm.Src_Repay_Type_Code\nAND rctm.Src_Column = 'OD_Type'\nAND b.src_sys_code = 'CHS'\nAND b.process_date BETWEEN rctm.From_Date AND rctm.To_Date"
          },
          "joinType" : "LEFT"
        } ],
        "expressions" : [ {
          "expression" : {
            "expression" : "b.armt_key"
          },
          "_row_id" : "1833577125"
        }, {
          "expression" : {
            "expression" : "b.src_sys_code"
          },
          "_row_id" : "1727922518"
        }, {
          "expression" : {
            "expression" : "b.src_repay_type_code"
          },
          "_row_id" : "2072092783"
        }, {
          "expression" : {
            "expression" : "b.src_column"
          },
          "_row_id" : "601484724"
        }, {
          "expression" : {
            "expression" : "b.mu001_product_code"
          },
          "_row_id" : "245043292"
        }, {
          "expression" : {
            "expression" : "b.mu001_system_product_type"
          },
          "_row_id" : "1847833731"
        }, {
          "expression" : {
            "expression" : "b.process_date"
          },
          "_row_id" : "1690833472"
        }, {
          "expression" : {
            "expression" : "rrtm.Repay_Type_Code"
          },
          "alias" : "mapped_repay_type",
          "_row_id" : "2065877799"
        }, {
          "expression" : {
            "expression" : "rctm.Repay_Type_Code"
          },
          "alias" : "chs_mapped_repay_type",
          "_row_id" : "1502631160"
        }, {
          "expression" : {
            "expression" : "''"
          },
          "alias" : "covid_carryover_value",
          "_row_id" : "1149712566"
        }, {
          "expression" : {
            "expression" : "CASE\n  WHEN b.src_sys_code = 'CHS' AND COALESCE(rctm.Repay_Type_Code, '') <> ''\n    THEN rctm.Repay_Type_Code\n  WHEN b.src_sys_code = 'MU-001'\n  AND b.mu001_product_code IN ('11752', '11753', '11758')\n  AND b.mu001_system_product_type = 'EAL'\n  AND COALESCE(rrtm.Repay_Type_Code, '') = ''\n    THEN 'Interest Only'\n  WHEN b.src_sys_code = 'MU-001'\n  AND b.mu001_product_code = '11206'\n  AND COALESCE(rrtm.Repay_Type_Code, '') = ''\n    THEN 'Interest Only'\n  WHEN b.src_sys_code = 'LIS'\n    THEN ''\n  WHEN b.src_sys_code <> 'CHS' AND COALESCE(rrtm.Repay_Type_Code, '') <> ''\n    THEN rrtm.Repay_Type_Code\n  ELSE 'Amortising'\nEND"
          },
          "alias" : "loan_repayment_type",
          "_row_id" : "494224130"
        }, {
          "expression" : {
            "expression" : "CASE\n  WHEN b.src_sys_code = 'CHS' AND COALESCE(rctm.Repay_Type_Code, '') <> ''\n    THEN 'Rule 1 - CHS OD_Type Mapping'\n  WHEN b.src_sys_code = 'MU-001'\n  AND b.mu001_product_code IN ('11752', '11753', '11758')\n  AND b.mu001_system_product_type = 'EAL'\n  AND COALESCE(rrtm.Repay_Type_Code, '') = ''\n    THEN 'Rule 2 - MU-001 EAL Product Default'\n  WHEN b.src_sys_code = 'MU-001'\n  AND b.mu001_product_code = '11206'\n  AND COALESCE(rrtm.Repay_Type_Code, '') = ''\n    THEN 'Rule 3 - MU-001 Product 11206 Default'\n  WHEN b.src_sys_code = 'LIS'\n    THEN 'Rule 4 - COVID Carryover'\n  WHEN b.src_sys_code <> 'CHS' AND COALESCE(rrtm.Repay_Type_Code, '') <> ''\n    THEN 'Rule 5 - Reference Mapping'\n  ELSE 'Rule 99 - Default Amortising'\nEND"
          },
          "alias" : "applied_rule",
          "_row_id" : "1014095518"
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "headAlias" : "b"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "L5GiIoRX",
          "slug" : "b"
        }, {
          "id" : "qpDN0qhE",
          "slug" : "rrtm"
        }, {
          "id" : "ubfcQFDO",
          "slug" : "rctm"
        } ],
        "outputs" : [ {
          "id" : "m7inbLdt",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "filtered_active_##iTRactei" : {
      "id" : "filtered_active_##iTRactei",
      "component" : "Filter",
      "metadata" : {
        "label" : "filtered_active_accounts",
        "x" : -320,
        "y" : 340,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zrms_From_Date AND zrms_To_Date"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "GA0Jpa8H",
          "slug" : "joined_account_repayment_data"
        } ],
        "outputs" : [ {
          "id" : "HaCgRgvs",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "zwgd_mrtg_loan_m##sdIWkXnl" : {
      "id" : "zwgd_mrtg_loan_m##sdIWkXnl",
      "component" : "Source",
      "metadata" : {
        "label" : "zwgd_mrtg_loan_m_hist",
        "x" : -720,
        "y" : 1100,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zwgd_mrtg_loan_m_hist",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "hWPsEUAq",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "zwgd_all_acct_m_##vsDU1v9j" : {
      "id" : "zwgd_all_acct_m_##vsDU1v9j",
      "component" : "Source",
      "metadata" : {
        "label" : "zwgd_all_acct_m_hist",
        "x" : -720,
        "y" : 960,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zwgd_all_acct_m_hist",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "KWAvQd18",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "Union_1##N9vjlIZW" : {
      "id" : "Union_1##N9vjlIZW",
      "component" : "Union",
      "metadata" : {
        "label" : "Union_1",
        "x" : 220,
        "y" : 580,
        "phase" : 0
      },
      "properties" : {
        "operationType" : "union",
        "preserveDuplicates" : false,
        "useMinus" : false,
        "inputAliases" : [ "in0", "in1", "in2", "in3", "in4" ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "hnTg64Xt",
          "slug" : "in0"
        }, {
          "id" : "zu3VjOCE",
          "slug" : "in1"
        }, {
          "id" : "X46tSk6b",
          "slug" : "in2"
        }, {
          "id" : "ZDH9mAl4",
          "slug" : "in3"
        }, {
          "id" : "GHqzknXG",
          "slug" : "in4"
        } ],
        "outputs" : [ {
          "id" : "yyM9Oq0A",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "joined_account_r##z1rdNtNL" : {
      "id" : "joined_account_r##z1rdNtNL",
      "component" : "Join",
      "metadata" : {
        "label" : "joined_account_repayment_data",
        "x" : -520,
        "y" : 340,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "zrms_la",
          "expression" : {
            "expression" : "zrms.Account_Id = zrms_la.Account_Id\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zrms_la.From_Date AND zrms_la.To_Date"
          },
          "joinType" : "LEFT"
        } ],
        "expressions" : [ {
          "expression" : {
            "expression" : "zrms_la.To_Date"
          },
          "alias" : "zrms_la_To_Date",
          "_row_id" : "761321313"
        }, {
          "expression" : {
            "expression" : "zrms_la.From_Date"
          },
          "alias" : "zrms_la_From_Date",
          "_row_id" : "1409675391"
        }, {
          "expression" : {
            "expression" : "zrms.To_Date"
          },
          "alias" : "zrms_To_Date",
          "_row_id" : "1694407637"
        }, {
          "expression" : {
            "expression" : "zrms_la.Repayment_Type"
          },
          "alias" : "zrms_la_Repayment_Type",
          "_row_id" : "1723057621"
        }, {
          "expression" : {
            "expression" : "zrms_la.Account_Id"
          },
          "alias" : "zrms_la_Account_Id",
          "_row_id" : "1169625823"
        }, {
          "expression" : {
            "expression" : "zrms.Account_Id"
          },
          "alias" : "zrms_Account_Id",
          "_row_id" : "1539958496"
        }, {
          "expression" : {
            "expression" : "zrms.From_Date"
          },
          "alias" : "zrms_From_Date",
          "_row_id" : "1620801597"
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "headAlias" : "zrms"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "kYzCDl3b",
          "slug" : "zrms"
        }, {
          "id" : "QwaDEyyD",
          "slug" : "zrms_la"
        } ],
        "outputs" : [ {
          "id" : "yNFas6GA",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "tbk_base##yE0S72oY" : {
      "id" : "tbk_base##yE0S72oY",
      "component" : "Reformat",
      "metadata" : {
        "label" : "tbk_base",
        "x" : -260,
        "y" : 80,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "ztbk.Armt_Key"
          },
          "alias" : "armt_key",
          "_row_id" : "545315428"
        }, {
          "expression" : {
            "expression" : "'TBK'"
          },
          "alias" : "src_sys_code",
          "_row_id" : "400701463"
        }, {
          "expression" : {
            "expression" : "COALESCE(ztbk.Repay_Type_Code, '')"
          },
          "alias" : "src_repay_type_code",
          "_row_id" : "983171671"
        }, {
          "expression" : {
            "expression" : "'Repay_Type_Code'"
          },
          "alias" : "src_column",
          "_row_id" : "1125722634"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_product_code",
          "_row_id" : "2021442698"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_system_product_type",
          "_row_id" : "107099201"
        }, {
          "expression" : {
            "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd')"
          },
          "alias" : "process_date",
          "_row_id" : "503179559"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "WwYfM6fE",
          "slug" : "ztbk"
        } ],
        "outputs" : [ {
          "id" : "AUL0Aeak",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "filtered_tbk_acc##eDATGJqy" : {
      "id" : "filtered_tbk_acc##eDATGJqy",
      "component" : "Filter",
      "metadata" : {
        "label" : "filtered_tbk_accounts",
        "x" : -460,
        "y" : 80,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN ztbk.From_Date AND ztbk.To_Date"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "FUwFKUbs",
          "slug" : "ztbk"
        } ],
        "outputs" : [ {
          "id" : "Su2BRYAc",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "mb_accounts_filt##uMMii4bp" : {
      "id" : "mb_accounts_filt##uMMii4bp",
      "component" : "Filter",
      "metadata" : {
        "label" : "mb_accounts_filtered",
        "x" : -320,
        "y" : 1040,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "Source_System_Code = 'MB'\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN From_Date AND To_Date"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "gv71zrZB",
          "slug" : "account_loan_product_join"
        } ],
        "outputs" : [ {
          "id" : "smGdfhDJ",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "account_date_fil##S08Exwto" : {
      "id" : "account_date_fil##S08Exwto",
      "component" : "Filter",
      "metadata" : {
        "label" : "account_date_filter",
        "x" : -320,
        "y" : 680,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN znex_From_Date AND znex_To_Date"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "boLeGSZx",
          "slug" : "account_loan_joined_data"
        } ],
        "outputs" : [ {
          "id" : "lwqrSCRM",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    }
  },
  "connections" : [ {
    "id" : "conn_loan_repayment_t##FaKYOccQ_m7inbLdt_loan_repayment_type_logic_m7inbLdt",
    "source" : "loan_repayment_t##FaKYOccQ",
    "sourcePort" : "m7inbLdt",
    "target" : "loan_repayment_type_logic_m7inbLdt",
    "targetPort" : "input_port_0"
  }, {
    "id" : "msdmf8YC",
    "source" : "Union_1##N9vjlIZW",
    "sourcePort" : "yyM9Oq0A",
    "target" : "loan_repayment_t##FaKYOccQ",
    "targetPort" : "L5GiIoRX"
  }, {
    "id" : "Sw8nMVCH",
    "source" : "refs_repay_type_##rzMGhEjo",
    "sourcePort" : "kpUUxC89",
    "target" : "loan_repayment_t##FaKYOccQ",
    "targetPort" : "qpDN0qhE"
  }, {
    "id" : "dmwiU02G",
    "source" : "refs_repay_type_##rzMGhEjo",
    "sourcePort" : "kpUUxC89",
    "target" : "loan_repayment_t##FaKYOccQ",
    "targetPort" : "ubfcQFDO"
  }, {
    "id" : "RTQzpcfP",
    "source" : "repay_type_sourc##pf1mpt7P",
    "sourcePort" : "KIP34bY3",
    "target" : "Union_1##N9vjlIZW",
    "targetPort" : "hnTg64Xt"
  }, {
    "id" : "DQt473z9",
    "source" : "tbk_base##yE0S72oY",
    "sourcePort" : "AUL0Aeak",
    "target" : "Union_1##N9vjlIZW",
    "targetPort" : "zu3VjOCE"
  }, {
    "id" : "P7lgyLhG",
    "source" : "repayment_type_e##IjhgFP6T",
    "sourcePort" : "Hc2y2HdJ",
    "target" : "Union_1##N9vjlIZW",
    "targetPort" : "X46tSk6b"
  }, {
    "id" : "PIbFAA52",
    "source" : "repay_type_code_##HQPt6sKU",
    "sourcePort" : "jR4P9JVs",
    "target" : "Union_1##N9vjlIZW",
    "targetPort" : "ZDH9mAl4"
  }, {
    "id" : "FG9OEsYR",
    "source" : "mu001_product_co##RTfylfxA",
    "sourcePort" : "SExlNsH4",
    "target" : "Union_1##N9vjlIZW",
    "targetPort" : "GHqzknXG"
  }, {
    "id" : "jQ2Mdgow",
    "source" : "filtered_source_##hyAg44j6",
    "sourcePort" : "J7HwAxgy",
    "target" : "repay_type_sourc##pf1mpt7P",
    "targetPort" : "snUL4gxS"
  }, {
    "id" : "XRWN8RzI",
    "source" : "filtered_tbk_acc##eDATGJqy",
    "sourcePort" : "Su2BRYAc",
    "target" : "tbk_base##yE0S72oY",
    "targetPort" : "WwYfM6fE"
  }, {
    "id" : "wqTMkdOz",
    "source" : "filtered_active_##iTRactei",
    "sourcePort" : "HaCgRgvs",
    "target" : "repayment_type_e##IjhgFP6T",
    "targetPort" : "Vu7ex5Ct"
  }, {
    "id" : "uT3PmCXc",
    "source" : "account_date_fil##S08Exwto",
    "sourcePort" : "lwqrSCRM",
    "target" : "repay_type_code_##HQPt6sKU",
    "targetPort" : "oJsQYNoc"
  }, {
    "id" : "elUCbFPC",
    "source" : "mb_accounts_filt##uMMii4bp",
    "sourcePort" : "smGdfhDJ",
    "target" : "mu001_product_co##RTfylfxA",
    "targetPort" : "igkZgIDn"
  }, {
    "id" : "RD6UvM2e",
    "source" : "source_repay_typ##Qc3eFU5e",
    "sourcePort" : "j5kVG072",
    "target" : "filtered_source_##hyAg44j6",
    "targetPort" : "kRe5DQJs"
  }, {
    "id" : "JSsYNNTr",
    "source" : "ztbk_account##lG10XNK8",
    "sourcePort" : "hJCGZSor",
    "target" : "filtered_tbk_acc##eDATGJqy",
    "targetPort" : "FUwFKUbs"
  }, {
    "id" : "GW6nfqd8",
    "source" : "joined_account_r##z1rdNtNL",
    "sourcePort" : "yNFas6GA",
    "target" : "filtered_active_##iTRactei",
    "targetPort" : "GA0Jpa8H"
  }, {
    "id" : "Jj9uedex",
    "source" : "account_loan_joi##LX9FU5ri",
    "sourcePort" : "O4mLCoyF",
    "target" : "account_date_fil##S08Exwto",
    "targetPort" : "boLeGSZx"
  }, {
    "id" : "NY86bsUW",
    "source" : "account_loan_pro##zmMtzv3e",
    "sourcePort" : "ENzDYR7d",
    "target" : "mb_accounts_filt##uMMii4bp",
    "targetPort" : "gv71zrZB"
  }, {
    "id" : "gGXOXwui",
    "source" : "zsgd_acct##f2BGzsBZ",
    "sourcePort" : "wAsx57n4",
    "target" : "source_repay_typ##Qc3eFU5e",
    "targetPort" : "LdVY1XPW"
  }, {
    "id" : "dXlbmQxL",
    "source" : "zsgd_acct##f2BGzsBZ",
    "sourcePort" : "wAsx57n4",
    "target" : "source_repay_typ##Qc3eFU5e",
    "targetPort" : "kcXw1DHp"
  }, {
    "id" : "q9sUY7K0",
    "source" : "zsgd_acct_loan##LWHnF8DB",
    "sourcePort" : "nwncvIOV",
    "target" : "source_repay_typ##Qc3eFU5e",
    "targetPort" : "TPqOuYOc"
  }, {
    "id" : "gAy4TrF8",
    "source" : "zrms_account##hXz7k6cG",
    "sourcePort" : "u88w3yej",
    "target" : "joined_account_r##z1rdNtNL",
    "targetPort" : "kYzCDl3b"
  }, {
    "id" : "AsFG0Cso",
    "source" : "zrms_loan_accoun##c4dGP6t6",
    "sourcePort" : "reuCrjmd",
    "target" : "joined_account_r##z1rdNtNL",
    "targetPort" : "QwaDEyyD"
  }, {
    "id" : "inNZzIrq",
    "source" : "znex_account##fuC2GH71",
    "sourcePort" : "zWfb2eoD",
    "target" : "account_loan_joi##LX9FU5ri",
    "targetPort" : "tUT2mW5w"
  }, {
    "id" : "YmmpLhCi",
    "source" : "znex_loan##YcJxwoeo",
    "sourcePort" : "vWIJiqft",
    "target" : "account_loan_joi##LX9FU5ri",
    "targetPort" : "oLjlMhzZ"
  }, {
    "id" : "tvBTzf63",
    "source" : "zwgd_all_acct_m_##vsDU1v9j",
    "sourcePort" : "KWAvQd18",
    "target" : "account_loan_pro##zmMtzv3e",
    "targetPort" : "QSpJLhmn"
  }, {
    "id" : "iLjgsz6z",
    "source" : "zwgd_mrtg_loan_m##sdIWkXnl",
    "sourcePort" : "hWPsEUAq",
    "target" : "account_loan_pro##zmMtzv3e",
    "targetPort" : "kmJLAjlb"
  } ],
  "component" : "Model"
}