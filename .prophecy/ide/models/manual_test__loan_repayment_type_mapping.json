{
  "id" : "manual_test__loan_repayment_type_mapping",
  "metainfo" : {
    "label" : "manual_test__loan_repayment_type_mapping",
    "autoLayout" : true,
    "staleState" : "none",
    "sourceSuggestions" : {
      "sources" : [ ]
    },
    "graphConfig" : {
      "entityConfig" : {
        "materialized" : "ephemeral",
        "database" : "\"main\"",
        "schema" : "\"default\"",
        "type" : "ModelConfig"
      }
    },
    "version" : 3
  },
  "processes" : {
    "XKdgsr36gbVkJ2_E6o-ci$$1tnBPFYkgvk4B5kbk6Ru_" : {
      "id" : "XKdgsr36gbVkJ2_E6o-ci$$1tnBPFYkgvk4B5kbk6Ru_",
      "component" : "Source",
      "metadata" : {
        "label" : "zwgd_mrtg_loan_m_hist",
        "x" : -720,
        "y" : 1100,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zwgd_mrtg_loan_m_hist",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "XFeZjPSWV5hRszb_7Q6zm$$IHuZcIczgGGBvqDMKtqrp",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "gY0QJsI1me5y9TtecxkYA$$VqrFPclpJ6rmCuBfjH9m0" : {
      "id" : "gY0QJsI1me5y9TtecxkYA$$VqrFPclpJ6rmCuBfjH9m0",
      "component" : "Source",
      "metadata" : {
        "label" : "ztbk_account",
        "x" : -660,
        "y" : 80,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "ztbk_account",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "JFRDIzOAbbi6myo4lojOp$$zdyaHgHsYKQXqThVsGdP4",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "WUMNk1vOoP7LjS5RCedUh$$zaJWXVbXi_PY-GaTrHivx" : {
      "id" : "WUMNk1vOoP7LjS5RCedUh$$zaJWXVbXi_PY-GaTrHivx",
      "component" : "Filter",
      "metadata" : {
        "label" : "mb_accounts_filtered",
        "x" : -320,
        "y" : 1040,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ "Ei8gkAScza38ZvGCPWoyy$$6WflcmUol7U0Gte5Twpim##Source_System_Code", "Ei8gkAScza38ZvGCPWoyy$$6WflcmUol7U0Gte5Twpim##From_Date", "Ei8gkAScza38ZvGCPWoyy$$6WflcmUol7U0Gte5Twpim##To_Date" ],
        "condition" : {
          "expression" : "Source_System_Code = 'MB'\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN From_Date AND To_Date"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Ei8gkAScza38ZvGCPWoyy$$6WflcmUol7U0Gte5Twpim",
          "slug" : "account_loan_product_join"
        } ],
        "outputs" : [ {
          "id" : "2uM_cXdyLdXFbW2gYvCLV$$QJW8Mes334PWL3XVAOA3e",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "2iizAFqOBTeJm2inIQblg$$9BtGc6xFSDN5h7usciTHP" : {
      "id" : "2iizAFqOBTeJm2inIQblg$$9BtGc6xFSDN5h7usciTHP",
      "component" : "Source",
      "metadata" : {
        "label" : "znex_loan",
        "x" : -720,
        "y" : 740,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "znex_loan",
          "sourceName" : "westpac_sgdw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "2FPvMporvYO1rFJFMWefK$$ndzXIJZaIN8YXePts4QTP",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "Ka1lMAkhSfbnRYtSuko0X$$xV8O6gCAsyjyd_k4j8xpL" : {
      "id" : "Ka1lMAkhSfbnRYtSuko0X$$xV8O6gCAsyjyd_k4j8xpL",
      "component" : "Reformat",
      "metadata" : {
        "label" : "repay_type_source_data",
        "x" : -80,
        "y" : -220,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ "uDfNqiPP6P7qDNTFYjXYZ$$A7BgJ4d3VZ49Fj_MEYfpi##zsgd_Armt_Key", "uDfNqiPP6P7qDNTFYjXYZ$$A7BgJ4d3VZ49Fj_MEYfpi##zsgd_Src_Sys_Code", "uDfNqiPP6P7qDNTFYjXYZ$$A7BgJ4d3VZ49Fj_MEYfpi##zsgd_a_OD_Type", "uDfNqiPP6P7qDNTFYjXYZ$$A7BgJ4d3VZ49Fj_MEYfpi##zsgd_al_Repay_Type_Code" ],
        "expressions" : [ {
          "expression" : {
            "expression" : "zsgd_Armt_Key"
          },
          "alias" : "armt_key",
          "_row_id" : "648779500"
        }, {
          "expression" : {
            "expression" : "zsgd_Src_Sys_Code"
          },
          "alias" : "src_sys_code",
          "_row_id" : "886487961"
        }, {
          "expression" : {
            "expression" : "CASE\n  WHEN zsgd_Src_Sys_Code = 'CHS'\n    THEN COALESCE(zsgd_a_OD_Type, '')\n  ELSE COALESCE(zsgd_al_Repay_Type_Code, '')\nEND"
          },
          "alias" : "src_repay_type_code",
          "_row_id" : "1079348626"
        }, {
          "expression" : {
            "expression" : "CASE\n  WHEN zsgd_Src_Sys_Code = 'CHS'\n    THEN 'OD_Type'\n  ELSE 'Repay_Type_Code'\nEND"
          },
          "alias" : "src_column",
          "_row_id" : "1397070322"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_product_code",
          "_row_id" : "2054741310"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_system_product_type",
          "_row_id" : "515213459"
        }, {
          "expression" : {
            "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd')"
          },
          "alias" : "process_date",
          "_row_id" : "1858562381"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "uDfNqiPP6P7qDNTFYjXYZ$$A7BgJ4d3VZ49Fj_MEYfpi",
          "slug" : "filtered_source_data"
        } ],
        "outputs" : [ {
          "id" : "_F1SF2JkNeFNxFaQK4jtj$$zqN1OAIHV-Ezw3f2IJc09",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "KLBNHqvpq_3oQmdE7t7YQ$$d9iUPN1jhOsfr3zLN5UzU" : {
      "id" : "KLBNHqvpq_3oQmdE7t7YQ$$d9iUPN1jhOsfr3zLN5UzU",
      "component" : "Join",
      "metadata" : {
        "label" : "account_loan_product_join",
        "x" : -520,
        "y" : 1040,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "zwgd_mrtg_loan_m_hist",
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.Account_Id = zwgd_mrtg_loan_m_hist.Account_Id\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zwgd_mrtg_loan_m_hist.From_Date AND zwgd_mrtg_loan_m_hist.To_Date"
          },
          "joinType" : "LEFT"
        } ],
        "expressions" : [ {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.Armt_Key"
          },
          "_row_id" : "92491133"
        }, {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.Source_System_Code"
          },
          "_row_id" : "145751963"
        }, {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.From_Date"
          },
          "_row_id" : "1019258764"
        }, {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.To_Date"
          },
          "_row_id" : "222908693"
        }, {
          "expression" : {
            "expression" : "zwgd_mrtg_loan_m_hist.Product_Code"
          },
          "_row_id" : "218261438"
        }, {
          "expression" : {
            "expression" : "zwgd_mrtg_loan_m_hist.System_Product_Type"
          },
          "_row_id" : "1938717808"
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ "Ijatyp1RFtV6OE4kRSLdu$$sh1mNT9rMLju04Ov3Qg3L##Account_Id", "4ExQi3_ncpjKuef4ejSnh$$kJtbviHvIPj8Jjx41ow5g##Account_Id", "4ExQi3_ncpjKuef4ejSnh$$kJtbviHvIPj8Jjx41ow5g##From_Date", "4ExQi3_ncpjKuef4ejSnh$$kJtbviHvIPj8Jjx41ow5g##To_Date", "Ijatyp1RFtV6OE4kRSLdu$$sh1mNT9rMLju04Ov3Qg3L##Armt_Key", "Ijatyp1RFtV6OE4kRSLdu$$sh1mNT9rMLju04Ov3Qg3L##Source_System_Code", "Ijatyp1RFtV6OE4kRSLdu$$sh1mNT9rMLju04Ov3Qg3L##From_Date", "Ijatyp1RFtV6OE4kRSLdu$$sh1mNT9rMLju04Ov3Qg3L##To_Date", "4ExQi3_ncpjKuef4ejSnh$$kJtbviHvIPj8Jjx41ow5g##Product_Code", "4ExQi3_ncpjKuef4ejSnh$$kJtbviHvIPj8Jjx41ow5g##System_Product_Type" ],
        "headAlias" : "zwgd_all_acct_m_hist"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Ijatyp1RFtV6OE4kRSLdu$$sh1mNT9rMLju04Ov3Qg3L",
          "slug" : "zwgd_all_acct_m_hist"
        }, {
          "id" : "4ExQi3_ncpjKuef4ejSnh$$kJtbviHvIPj8Jjx41ow5g",
          "slug" : "zwgd_mrtg_loan_m_hist"
        } ],
        "outputs" : [ {
          "id" : "9vyAehvOo23zd2dVH04cH$$Oqz3fEEDXy1VGVcPc5Sev",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "L-BOcXvly_gw6oofAithx$$HurZpZo4BdwNSVz7766mD" : {
      "id" : "L-BOcXvly_gw6oofAithx$$HurZpZo4BdwNSVz7766mD",
      "component" : "Join",
      "metadata" : {
        "label" : "account_loan_joined_data",
        "x" : -520,
        "y" : 680,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "znex_l",
          "expression" : {
            "expression" : "znex.Account_Id = znex_l.Account_Id\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN znex_l.From_Date AND znex_l.To_Date"
          },
          "joinType" : "LEFT"
        } ],
        "expressions" : [ {
          "expression" : {
            "expression" : "znex_l.Account_Id"
          },
          "alias" : "znex_l_Account_Id",
          "_row_id" : "1869483986"
        }, {
          "expression" : {
            "expression" : "znex.Account_Id"
          },
          "alias" : "znex_Account_Id",
          "_row_id" : "514978076"
        }, {
          "expression" : {
            "expression" : "znex_l.From_Date"
          },
          "alias" : "znex_l_From_Date",
          "_row_id" : "651909656"
        }, {
          "expression" : {
            "expression" : "znex.Armt_Key"
          },
          "alias" : "znex_Armt_Key",
          "_row_id" : "784807421"
        }, {
          "expression" : {
            "expression" : "znex_l.Repay_Type_Code"
          },
          "alias" : "znex_l_Repay_Type_Code",
          "_row_id" : "701002160"
        }, {
          "expression" : {
            "expression" : "znex.From_Date"
          },
          "alias" : "znex_From_Date",
          "_row_id" : "851827433"
        }, {
          "expression" : {
            "expression" : "znex.To_Date"
          },
          "alias" : "znex_To_Date",
          "_row_id" : "1698683809"
        }, {
          "expression" : {
            "expression" : "znex_l.To_Date"
          },
          "alias" : "znex_l_To_Date",
          "_row_id" : "1757575954"
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ "-qL3Gwh97QcKT_9Ls7YhX$$jFDZHjA5l-PqsAk7x91Gn##Account_Id", "3FtalKbSsYrw5URGRTt8b$$iiuss3e9NZ_1putx9LzXf##Account_Id", "3FtalKbSsYrw5URGRTt8b$$iiuss3e9NZ_1putx9LzXf##From_Date", "3FtalKbSsYrw5URGRTt8b$$iiuss3e9NZ_1putx9LzXf##To_Date", "3FtalKbSsYrw5URGRTt8b$$iiuss3e9NZ_1putx9LzXf##Account_Id", "-qL3Gwh97QcKT_9Ls7YhX$$jFDZHjA5l-PqsAk7x91Gn##Account_Id", "3FtalKbSsYrw5URGRTt8b$$iiuss3e9NZ_1putx9LzXf##From_Date", "-qL3Gwh97QcKT_9Ls7YhX$$jFDZHjA5l-PqsAk7x91Gn##Armt_Key", "3FtalKbSsYrw5URGRTt8b$$iiuss3e9NZ_1putx9LzXf##Repay_Type_Code", "-qL3Gwh97QcKT_9Ls7YhX$$jFDZHjA5l-PqsAk7x91Gn##From_Date", "-qL3Gwh97QcKT_9Ls7YhX$$jFDZHjA5l-PqsAk7x91Gn##To_Date", "3FtalKbSsYrw5URGRTt8b$$iiuss3e9NZ_1putx9LzXf##To_Date" ],
        "headAlias" : "znex"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "-qL3Gwh97QcKT_9Ls7YhX$$jFDZHjA5l-PqsAk7x91Gn",
          "slug" : "znex"
        }, {
          "id" : "3FtalKbSsYrw5URGRTt8b$$iiuss3e9NZ_1putx9LzXf",
          "slug" : "znex_l"
        } ],
        "outputs" : [ {
          "id" : "OyjZANIHtSEiRHY6WOmD6$$sn5wF4g6urj_SODJH2Efc",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "k00GcMHDKXs0zGMQ-wpEL$$ywyTMKjwiFHxXZFztdxfl" : {
      "id" : "k00GcMHDKXs0zGMQ-wpEL$$ywyTMKjwiFHxXZFztdxfl",
      "component" : "Source",
      "metadata" : {
        "label" : "znex_account",
        "x" : -720,
        "y" : 600,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "znex_account",
          "sourceName" : "westpac_sgdw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "hJJmw3Cb0iAgCywiXuFAX$$S15xSjd1gaRBHwuE3JjRP",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "loan_repayment_type_mapping_JXi0TzLXxNYauLnBDPERm$$U96JagFdUQG9WEAQuitH4" : {
      "id" : "loan_repayment_type_mapping_JXi0TzLXxNYauLnBDPERm$$U96JagFdUQG9WEAQuitH4",
      "component" : "TargetModel",
      "metadata" : {
        "label" : "loan_repayment_type_mapping"
      },
      "properties" : {
        "customQueryDisabled" : true,
        "customQuery" : false,
        "incrementalEditorDisabled" : true,
        "query" : "\nSELECT *\n\nFROM loan_repayment_type_mapping\n\n",
        "isModel" : true,
        "incrementalKey" : false,
        "incremental" : {
          "expression" : "true"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "input_port_0",
          "slug" : "input_port_0"
        } ],
        "outputs" : [ {
          "id" : "output_port_0",
          "slug" : "output_port_0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "awLTyUKbvtJs0bVtyQtz5$$j6YScd_TZQIaczBCxC_Xg" : {
      "id" : "awLTyUKbvtJs0bVtyQtz5$$j6YScd_TZQIaczBCxC_Xg",
      "component" : "Reformat",
      "metadata" : {
        "label" : "mu001_product_code_mapping",
        "x" : -120,
        "y" : 1040,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ "HH9TevrBk18SynDCl5T2l$$VT2iIvsdlb7HahNoxzSrn##Armt_Key", "HH9TevrBk18SynDCl5T2l$$VT2iIvsdlb7HahNoxzSrn##Product_Code", "HH9TevrBk18SynDCl5T2l$$VT2iIvsdlb7HahNoxzSrn##System_Product_Type" ],
        "expressions" : [ {
          "expression" : {
            "expression" : "Armt_Key"
          },
          "alias" : "ARMT_KEY",
          "_row_id" : "1036800087"
        }, {
          "expression" : {
            "expression" : "'MU-001'"
          },
          "alias" : "SRC_SYS_CODE",
          "_row_id" : "640056077"
        }, {
          "expression" : {
            "expression" : "''"
          },
          "alias" : "SRC_REPAY_TYPE_CODE",
          "_row_id" : "883938952"
        }, {
          "expression" : {
            "expression" : "'Product_Code'"
          },
          "alias" : "SRC_COLUMN",
          "_row_id" : "423397447"
        }, {
          "expression" : {
            "expression" : "Product_Code"
          },
          "alias" : "MU001_PRODUCT_CODE",
          "_row_id" : "1583641008"
        }, {
          "expression" : {
            "expression" : "System_Product_Type"
          },
          "alias" : "MU001_SYSTEM_PRODUCT_TYPE",
          "_row_id" : "1938823482"
        }, {
          "expression" : {
            "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd')"
          },
          "alias" : "PROCESS_DATE",
          "_row_id" : "1553183921"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "HH9TevrBk18SynDCl5T2l$$VT2iIvsdlb7HahNoxzSrn",
          "slug" : "mb_accounts_filtered"
        } ],
        "outputs" : [ {
          "id" : "1q5yRtEH0IfJv5RfkgPzB$$pdNSJJ1KvppNwHHVTBEzq",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "IbX8bwjmzJVwEJNWQ-JQC$$RB73B2sjrHhZwV3FUAlz0" : {
      "id" : "IbX8bwjmzJVwEJNWQ-JQC$$RB73B2sjrHhZwV3FUAlz0",
      "component" : "Source",
      "metadata" : {
        "label" : "zsgd_acct_loan",
        "x" : -680,
        "y" : -160,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zsgd_acct_loan",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "8vn_me9n7Qunpvb91O0ER$$DRaAI5Lmzv7XXSbhHqWPk",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "S1kGWxZmHKORciv2U-rft$$yGFtXk0Nh4rPFUW65LKq5" : {
      "id" : "S1kGWxZmHKORciv2U-rft$$yGFtXk0Nh4rPFUW65LKq5",
      "component" : "SQLStatement",
      "metadata" : {
        "label" : "loan_repayment_type_mapping",
        "x" : 460,
        "y" : 600,
        "phase" : 0
      },
      "properties" : {
        "fileTabs" : [ {
          "path" : "out",
          "id" : "out",
          "language" : "sql",
          "content" : "SELECT \n  b.armt_key,\n  b.src_sys_code,\n  b.src_repay_type_code,\n  b.src_column,\n  b.mu001_product_code,\n  b.mu001_system_product_type,\n  b.process_date,\n  -- Reference mapping lookups\n  rrtm.repay_type_code AS mapped_repay_type,\n  rctm.repay_type_code AS chs_mapped_repay_type,\n  COALESCE(covid.covid_efs_repay_type_code, '') AS covid_carryover_value,\n  -- ====================================================================\n  -- BUSINESS RULES APPLICATION\n  -- ====================================================================\n  CASE\n    WHEN b.src_sys_code = 'CHS' AND COALESCE(rctm.repay_type_code, '') <> ''\n      THEN rctm.repay_type_code\n    WHEN b.src_sys_code = 'MU-001'\n    AND b.mu001_product_code IN ('11752', '11753', '11758')\n    AND b.mu001_system_product_type = 'EAL'\n    AND COALESCE(rrtm.repay_type_code, '') = ''\n      THEN 'Interest Only'\n    WHEN b.src_sys_code = 'MU-001'\n    AND b.mu001_product_code = '11206'\n    AND COALESCE(rrtm.repay_type_code, '') = ''\n      THEN 'Interest Only'\n    WHEN b.src_sys_code = 'LIS' AND COALESCE(covid.covid_efs_repay_type_code, '') <> ''\n      THEN covid.covid_efs_repay_type_code\n    WHEN b.src_sys_code <> 'CHS' AND COALESCE(rrtm.repay_type_code, '') <> ''\n      THEN rrtm.repay_type_code\n    ELSE 'Amortising'\n  END AS loan_repayment_type,\n  CASE\n    WHEN b.src_sys_code = 'CHS' AND COALESCE(rctm.repay_type_code, '') <> ''\n      THEN 'Rule 1 - CHS OD_Type Mapping'\n    WHEN b.src_sys_code = 'MU-001'\n    AND b.mu001_product_code IN ('11752', '11753', '11758')\n    AND b.mu001_system_product_type = 'EAL'\n    AND COALESCE(rrtm.repay_type_code, '') = ''\n      THEN 'Rule 2 - MU-001 EAL Product Default'\n    WHEN b.src_sys_code = 'MU-001'\n    AND b.mu001_product_code = '11206'\n    AND COALESCE(rrtm.repay_type_code, '') = ''\n      THEN 'Rule 3 - MU-001 Product 11206 Default'\n    WHEN b.src_sys_code = 'LIS' AND COALESCE(covid.covid_efs_repay_type_code, '') <> ''\n      THEN 'Rule 4 - COVID Carryover'\n    WHEN b.src_sys_code <> 'CHS' AND COALESCE(rrtm.repay_type_code, '') <> ''\n      THEN 'Rule 5 - Reference Mapping'\n    ELSE 'Rule 99 - Default Amortising'\n  END AS applied_rule\n\nFROM all_sources AS b\nLEFT JOIN {{ source('efs', 'refs_repay_type_map') }} AS rrtm\n   ON b.src_sys_code = rrtm.src_sys_code\n  AND b.src_repay_type_code = rrtm.src_repay_type_code\n  AND rrtm.src_column = 'Repay_Type_Code'\n  AND to_date('{{ ref_effective_date }}', 'yyyyMMdd') BETWEEN rrtm.from_date AND rrtm.to_date\nLEFT JOIN {{ source('efs', 'refs_repay_type_map') }} AS rctm\n   ON b.src_sys_code = rctm.src_sys_code\n  AND b.src_repay_type_code = rctm.src_repay_type_code\n  AND rctm.src_column = 'OD_Type'\n  AND b.src_sys_code = 'CHS'\n  AND to_date('{{ ref_effective_date }}', 'yyyyMMdd') BETWEEN rctm.from_date AND rctm.to_date\nLEFT JOIN {{ source('efs', 'refs_covid_repay_type') }} AS covid\n   ON b.armt_key = covid.armt_key AND b.src_sys_code = 'LIS'\n"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "jAf7TyndYRocaSbtAWgUg$$_iZOWHFjtZKGNVIV072zg",
          "slug" : "Union_1"
        } ],
        "outputs" : [ {
          "id" : "JXi0TzLXxNYauLnBDPERm$$U96JagFdUQG9WEAQuitH4",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "TIcLGwkzq2ANqRW--YSEQ$$koeF0ZrY51k4y1xWekbJb" : {
      "id" : "TIcLGwkzq2ANqRW--YSEQ$$koeF0ZrY51k4y1xWekbJb",
      "component" : "Join",
      "metadata" : {
        "label" : "joined_account_repayment_data",
        "x" : -520,
        "y" : 340,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "zrms_la",
          "expression" : {
            "expression" : "zrms.Account_Id = zrms_la.Account_Id\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zrms_la.From_Date AND zrms_la.To_Date"
          },
          "joinType" : "LEFT"
        } ],
        "expressions" : [ {
          "expression" : {
            "expression" : "zrms_la.To_Date"
          },
          "alias" : "zrms_la_To_Date",
          "_row_id" : "1577662371"
        }, {
          "expression" : {
            "expression" : "zrms_la.From_Date"
          },
          "alias" : "zrms_la_From_Date",
          "_row_id" : "1959381396"
        }, {
          "expression" : {
            "expression" : "zrms.To_Date"
          },
          "alias" : "zrms_To_Date",
          "_row_id" : "600136879"
        }, {
          "expression" : {
            "expression" : "zrms_la.Repayment_Type"
          },
          "alias" : "zrms_la_Repayment_Type",
          "_row_id" : "2141710205"
        }, {
          "expression" : {
            "expression" : "zrms_la.Account_Id"
          },
          "alias" : "zrms_la_Account_Id",
          "_row_id" : "1251744585"
        }, {
          "expression" : {
            "expression" : "zrms.Account_Id"
          },
          "alias" : "zrms_Account_Id",
          "_row_id" : "51597024"
        }, {
          "expression" : {
            "expression" : "zrms.From_Date"
          },
          "alias" : "zrms_From_Date",
          "_row_id" : "544337521"
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ "ZTABR8ipnGjmuu8FHwUuv$$Tsbn_N7aSMyB64CUCobCD##Account_Id", "C2cOSFzMCte3HIn_Lissd$$mn6wc411umF-df1DoVRFa##Account_Id", "C2cOSFzMCte3HIn_Lissd$$mn6wc411umF-df1DoVRFa##From_Date", "C2cOSFzMCte3HIn_Lissd$$mn6wc411umF-df1DoVRFa##To_Date", "C2cOSFzMCte3HIn_Lissd$$mn6wc411umF-df1DoVRFa##To_Date", "C2cOSFzMCte3HIn_Lissd$$mn6wc411umF-df1DoVRFa##From_Date", "ZTABR8ipnGjmuu8FHwUuv$$Tsbn_N7aSMyB64CUCobCD##To_Date", "C2cOSFzMCte3HIn_Lissd$$mn6wc411umF-df1DoVRFa##Repayment_Type", "C2cOSFzMCte3HIn_Lissd$$mn6wc411umF-df1DoVRFa##Account_Id", "ZTABR8ipnGjmuu8FHwUuv$$Tsbn_N7aSMyB64CUCobCD##Account_Id", "ZTABR8ipnGjmuu8FHwUuv$$Tsbn_N7aSMyB64CUCobCD##From_Date" ],
        "headAlias" : "zrms"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ZTABR8ipnGjmuu8FHwUuv$$Tsbn_N7aSMyB64CUCobCD",
          "slug" : "zrms"
        }, {
          "id" : "C2cOSFzMCte3HIn_Lissd$$mn6wc411umF-df1DoVRFa",
          "slug" : "zrms_la"
        } ],
        "outputs" : [ {
          "id" : "MJGxv1rAs-Tcqlprbp7_A$$ehz6ZZdGs2roFS5iCDJB_",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "mtmjA6pwwBI6rDG3TbD8I$$RG6_TMdKixWlr-bPGgn2r" : {
      "id" : "mtmjA6pwwBI6rDG3TbD8I$$RG6_TMdKixWlr-bPGgn2r",
      "component" : "Union",
      "metadata" : {
        "label" : "Union_1",
        "x" : 220,
        "y" : 580,
        "phase" : 0
      },
      "properties" : {
        "operationType" : "union",
        "preserveDuplicates" : false,
        "useMinus" : false,
        "inputAliases" : [ "in0", "in1", "in2", "in3", "in4" ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LwhqIG7HBh-M_iAnEBg9p$$XVcL8Pu5B56w_h-tSykQJ",
          "slug" : "in0"
        }, {
          "id" : "MD3Ct4S2CvJ9DkxuyoOlb$$w_WE4uhAldoT3dfToWO_G",
          "slug" : "in1"
        }, {
          "id" : "k24S0yrbGH2ub_gmtASn0$$06Qc25QhnLohKYCOgC8Pp",
          "slug" : "in2"
        }, {
          "id" : "mQ11KxoHVIiK_a7pFaLJK$$UJ_12QXSgzMkCc6D3rvWK",
          "slug" : "in3"
        }, {
          "id" : "WPBqvuYlhkCN41AzqGqqJ$$f_s3yDA9b_pJfDIAAuLcw",
          "slug" : "in4"
        } ],
        "outputs" : [ {
          "id" : "DfZK21BGARu7gAh1DzTF9$$mLiajPv-PeY0JmGfgFFR5",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "jzFgSqX2Pg71yfE6lTWcV$$20Aw6k1bDWYfGm7k5THgb" : {
      "id" : "jzFgSqX2Pg71yfE6lTWcV$$20Aw6k1bDWYfGm7k5THgb",
      "component" : "Filter",
      "metadata" : {
        "label" : "filtered_active_accounts",
        "x" : -320,
        "y" : 340,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ "ULgDyz5HAuW2a0soBoZIX$$Br-dtyfaufkIrjvPz4x17##zrms_From_Date", "ULgDyz5HAuW2a0soBoZIX$$Br-dtyfaufkIrjvPz4x17##zrms_To_Date" ],
        "condition" : {
          "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zrms_From_Date AND zrms_To_Date"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ULgDyz5HAuW2a0soBoZIX$$Br-dtyfaufkIrjvPz4x17",
          "slug" : "joined_account_repayment_data"
        } ],
        "outputs" : [ {
          "id" : "MbNEytxKib9pJhTNLzVPy$$lUI7qTHv-wa_aMd73AGTr",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "2TEma7YuE5DSrp4SXy09r$$m5iBolAmfSmG_cswYk7qj" : {
      "id" : "2TEma7YuE5DSrp4SXy09r$$m5iBolAmfSmG_cswYk7qj",
      "component" : "Source",
      "metadata" : {
        "label" : "zsgd_acct",
        "x" : -680,
        "y" : -300,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zsgd_acct",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "AHO0PyJwA50GIiJ0qVIHh$$8GUH5Yaf0x02ll8hHUTPr",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "mm0ck3r2hJylyqxhjtF0A$$bi19BWDBI42mTgLwhPb-T" : {
      "id" : "mm0ck3r2hJylyqxhjtF0A$$bi19BWDBI42mTgLwhPb-T",
      "component" : "Reformat",
      "metadata" : {
        "label" : "repayment_type_extraction",
        "x" : -120,
        "y" : 340,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ "dN5JfWSd0ag1XehiP8XF8$$FkuZxXjE30Y_RHIfV8S2W##zrms_Account_Id", "dN5JfWSd0ag1XehiP8XF8$$FkuZxXjE30Y_RHIfV8S2W##zrms_la_Repayment_Type" ],
        "expressions" : [ {
          "expression" : {
            "expression" : "zrms_Account_Id"
          },
          "alias" : "armt_key",
          "_row_id" : "579843626"
        }, {
          "expression" : {
            "expression" : "'RMS'"
          },
          "alias" : "src_sys_code",
          "_row_id" : "2044400654"
        }, {
          "expression" : {
            "expression" : "COALESCE(zrms_la_Repayment_Type, '')"
          },
          "alias" : "src_repay_type_code",
          "_row_id" : "1255314376"
        }, {
          "expression" : {
            "expression" : "'Repayment_Type'"
          },
          "alias" : "src_column",
          "_row_id" : "1039702153"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_product_code",
          "_row_id" : "912711315"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_system_product_type",
          "_row_id" : "1891978377"
        }, {
          "expression" : {
            "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd')"
          },
          "alias" : "process_date",
          "_row_id" : "1809076906"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "dN5JfWSd0ag1XehiP8XF8$$FkuZxXjE30Y_RHIfV8S2W",
          "slug" : "filtered_active_accounts"
        } ],
        "outputs" : [ {
          "id" : "N7IS9YutsJNdVduG2JQqc$$rK1iz--TUSr_v13VUJPWw",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "LsYgYhWoyM4L3X4wBFI0u$$2GTSOM0MoHjs8qsb5t0Os" : {
      "id" : "LsYgYhWoyM4L3X4wBFI0u$$2GTSOM0MoHjs8qsb5t0Os",
      "component" : "Filter",
      "metadata" : {
        "label" : "filtered_tbk_accounts",
        "x" : -460,
        "y" : 80,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN ztbk.From_Date AND ztbk.To_Date"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "_rOrGQniITcOlJ216sKSX$$SuKD78kkdFhaoArP1PVb1",
          "slug" : "ztbk"
        } ],
        "outputs" : [ {
          "id" : "C_TsE3dCOpkNOdKLTDeSz$$aAVlLRetqgDoAQGEDoW2C",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "_HZzro8gcfOsRy2XDFzAH$$lzkQ4Ch1yOHejEra_WYq6" : {
      "id" : "_HZzro8gcfOsRy2XDFzAH$$lzkQ4Ch1yOHejEra_WYq6",
      "component" : "Reformat",
      "metadata" : {
        "label" : "repay_type_code_extract",
        "x" : -120,
        "y" : 680,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ "v9RAnEdjbnLQmcOqdFbOE$$A-gJBLDMJOyx_SksZ9pa0##znex_Armt_Key", "v9RAnEdjbnLQmcOqdFbOE$$A-gJBLDMJOyx_SksZ9pa0##znex_l_Repay_Type_Code" ],
        "expressions" : [ {
          "expression" : {
            "expression" : "znex_Armt_Key"
          },
          "alias" : "armt_key",
          "_row_id" : "1665697324"
        }, {
          "expression" : {
            "expression" : "'ML-005'"
          },
          "alias" : "src_sys_code",
          "_row_id" : "2120570248"
        }, {
          "expression" : {
            "expression" : "COALESCE(znex_l_Repay_Type_Code, '')"
          },
          "alias" : "src_repay_type_code",
          "_row_id" : "10426375"
        }, {
          "expression" : {
            "expression" : "'Repay_Type_Code'"
          },
          "alias" : "src_column",
          "_row_id" : "589525024"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_product_code",
          "_row_id" : "692339868"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_system_product_type",
          "_row_id" : "1414899082"
        }, {
          "expression" : {
            "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd')"
          },
          "alias" : "process_date",
          "_row_id" : "603139226"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "v9RAnEdjbnLQmcOqdFbOE$$A-gJBLDMJOyx_SksZ9pa0",
          "slug" : "account_date_filter"
        } ],
        "outputs" : [ {
          "id" : "NjZnONu-Rfc-Gokhhg4sb$$b34s-9V5xOfk5FAYQ6fRO",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "G42-Yj1KdPshfEaw5dodv$$emnDf7lKhswJmGTFFj5Pz" : {
      "id" : "G42-Yj1KdPshfEaw5dodv$$emnDf7lKhswJmGTFFj5Pz",
      "component" : "Join",
      "metadata" : {
        "label" : "source_repay_type_data",
        "x" : -480,
        "y" : -220,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "zsgd_al",
          "expression" : {
            "expression" : "zsgd.Acct_Key = zsgd_al.Acct_Key\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zsgd_al.From_Date AND zsgd_al.To_Date"
          },
          "joinType" : "LEFT"
        }, {
          "alias" : "zsgd_a",
          "expression" : {
            "expression" : "zsgd.Acct_Key = zsgd_a.Acct_Key\nAND zsgd.Src_Sys_Code = 'CHS'\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zsgd_a.From_Date AND zsgd_a.To_Date"
          },
          "joinType" : "LEFT"
        } ],
        "expressions" : [ {
          "expression" : {
            "expression" : "zsgd.From_Date"
          },
          "alias" : "zsgd_From_Date",
          "_row_id" : "1298858320"
        }, {
          "expression" : {
            "expression" : "zsgd.To_Date"
          },
          "alias" : "zsgd_To_Date",
          "_row_id" : "1981648671"
        }, {
          "expression" : {
            "expression" : "zsgd.Acct_Key"
          },
          "alias" : "zsgd_Acct_Key",
          "_row_id" : "1513454321"
        }, {
          "expression" : {
            "expression" : "zsgd_al.Acct_Key"
          },
          "alias" : "zsgd_al_Acct_Key",
          "_row_id" : "1990650142"
        }, {
          "expression" : {
            "expression" : "zsgd.Src_Sys_Code"
          },
          "alias" : "zsgd_Src_Sys_Code",
          "_row_id" : "2018373683"
        }, {
          "expression" : {
            "expression" : "zsgd_al.From_Date"
          },
          "alias" : "zsgd_al_From_Date",
          "_row_id" : "852955723"
        }, {
          "expression" : {
            "expression" : "zsgd_a.From_Date"
          },
          "alias" : "zsgd_a_From_Date",
          "_row_id" : "53811000"
        }, {
          "expression" : {
            "expression" : "zsgd_al.To_Date"
          },
          "alias" : "zsgd_al_To_Date",
          "_row_id" : "2008713261"
        }, {
          "expression" : {
            "expression" : "zsgd_a.To_Date"
          },
          "alias" : "zsgd_a_To_Date",
          "_row_id" : "1378659773"
        }, {
          "expression" : {
            "expression" : "zsgd_al.Repay_Type_Code"
          },
          "alias" : "zsgd_al_Repay_Type_Code",
          "_row_id" : "228762468"
        }, {
          "expression" : {
            "expression" : "zsgd_a.OD_Type"
          },
          "alias" : "zsgd_a_OD_Type",
          "_row_id" : "1806527352"
        }, {
          "expression" : {
            "expression" : "zsgd.Armt_Key"
          },
          "alias" : "zsgd_Armt_Key",
          "_row_id" : "1862817909"
        }, {
          "expression" : {
            "expression" : "zsgd_a.Acct_Key"
          },
          "alias" : "zsgd_a_Acct_Key",
          "_row_id" : "1265169433"
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ "CmyWMd9i9oR97H7dAI4_1$$lY5SaY9WY0nD3X81ZYRAG##Acct_Key", "fLU3G_GBI_zVkx9sxJxDj$$Ercnm4TgDapkChhe8DZt_##Acct_Key", "fLU3G_GBI_zVkx9sxJxDj$$Ercnm4TgDapkChhe8DZt_##From_Date", "fLU3G_GBI_zVkx9sxJxDj$$Ercnm4TgDapkChhe8DZt_##To_Date", "7MIBnsDScPxjvgXvP1GEY$$s9afbwr_gfhVri9V9n4qe##Acct_Key", "CmyWMd9i9oR97H7dAI4_1$$lY5SaY9WY0nD3X81ZYRAG##Src_Sys_Code", "7MIBnsDScPxjvgXvP1GEY$$s9afbwr_gfhVri9V9n4qe##From_Date", "7MIBnsDScPxjvgXvP1GEY$$s9afbwr_gfhVri9V9n4qe##To_Date", "CmyWMd9i9oR97H7dAI4_1$$lY5SaY9WY0nD3X81ZYRAG##From_Date", "CmyWMd9i9oR97H7dAI4_1$$lY5SaY9WY0nD3X81ZYRAG##To_Date", "CmyWMd9i9oR97H7dAI4_1$$lY5SaY9WY0nD3X81ZYRAG##Acct_Key", "fLU3G_GBI_zVkx9sxJxDj$$Ercnm4TgDapkChhe8DZt_##Acct_Key", "CmyWMd9i9oR97H7dAI4_1$$lY5SaY9WY0nD3X81ZYRAG##Src_Sys_Code", "fLU3G_GBI_zVkx9sxJxDj$$Ercnm4TgDapkChhe8DZt_##From_Date", "7MIBnsDScPxjvgXvP1GEY$$s9afbwr_gfhVri9V9n4qe##From_Date", "fLU3G_GBI_zVkx9sxJxDj$$Ercnm4TgDapkChhe8DZt_##To_Date", "7MIBnsDScPxjvgXvP1GEY$$s9afbwr_gfhVri9V9n4qe##To_Date", "fLU3G_GBI_zVkx9sxJxDj$$Ercnm4TgDapkChhe8DZt_##Repay_Type_Code", "7MIBnsDScPxjvgXvP1GEY$$s9afbwr_gfhVri9V9n4qe##OD_Type", "CmyWMd9i9oR97H7dAI4_1$$lY5SaY9WY0nD3X81ZYRAG##Armt_Key", "7MIBnsDScPxjvgXvP1GEY$$s9afbwr_gfhVri9V9n4qe##Acct_Key" ],
        "headAlias" : "zsgd"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "CmyWMd9i9oR97H7dAI4_1$$lY5SaY9WY0nD3X81ZYRAG",
          "slug" : "zsgd"
        }, {
          "id" : "fLU3G_GBI_zVkx9sxJxDj$$Ercnm4TgDapkChhe8DZt_",
          "slug" : "zsgd_al"
        }, {
          "id" : "7MIBnsDScPxjvgXvP1GEY$$s9afbwr_gfhVri9V9n4qe",
          "slug" : "zsgd_a"
        } ],
        "outputs" : [ {
          "id" : "3u9_Xl_rh82_CYcQN-C4L$$ndUMQ5pCfAK-b2wfHw05c",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "6gPKv6RlzWqQqXKlley_G$$8ZKARztIHUCW59r1N08Lp" : {
      "id" : "6gPKv6RlzWqQqXKlley_G$$8ZKARztIHUCW59r1N08Lp",
      "component" : "Filter",
      "metadata" : {
        "label" : "filtered_source_data",
        "x" : -280,
        "y" : -220,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ "oXoRTbX0AJcY3tl8nVYvz$$cubb7Ywz-rzr5HprhdfrR##zsgd_From_Date", "oXoRTbX0AJcY3tl8nVYvz$$cubb7Ywz-rzr5HprhdfrR##zsgd_To_Date", "oXoRTbX0AJcY3tl8nVYvz$$cubb7Ywz-rzr5HprhdfrR##zsgd_Src_Sys_Code" ],
        "condition" : {
          "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zsgd_From_Date AND zsgd_To_Date\nAND zsgd_Src_Sys_Code IN ('LIS', 'DDA', 'CHA', 'LNS', 'CHS')"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "oXoRTbX0AJcY3tl8nVYvz$$cubb7Ywz-rzr5HprhdfrR",
          "slug" : "source_repay_type_data"
        } ],
        "outputs" : [ {
          "id" : "1PiVMjgJ1F7opoMyFF5sd$$8BLdm3-kwAjUAjcwpu1xH",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "z2ZzCkr81tI69xfB8uV-0$$pJLKrwEUD2C8gSIE8Fg3x" : {
      "id" : "z2ZzCkr81tI69xfB8uV-0$$pJLKrwEUD2C8gSIE8Fg3x",
      "component" : "Reformat",
      "metadata" : {
        "label" : "tbk_base",
        "x" : -260,
        "y" : 80,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "ztbk.Armt_Key"
          },
          "alias" : "armt_key",
          "_row_id" : "1437809898"
        }, {
          "expression" : {
            "expression" : "'TBK'"
          },
          "alias" : "src_sys_code",
          "_row_id" : "263677967"
        }, {
          "expression" : {
            "expression" : "COALESCE(ztbk.Repay_Type_Code, '')"
          },
          "alias" : "src_repay_type_code",
          "_row_id" : "429193836"
        }, {
          "expression" : {
            "expression" : "'Repay_Type_Code'"
          },
          "alias" : "src_column",
          "_row_id" : "566771761"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_product_code",
          "_row_id" : "524739963"
        }, {
          "expression" : {
            "expression" : "CAST(NULL AS STRING)"
          },
          "alias" : "mu001_system_product_type",
          "_row_id" : "86315760"
        }, {
          "expression" : {
            "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd')"
          },
          "alias" : "process_date",
          "_row_id" : "835654199"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "nYFVpLlCPP3skWHr8wKAH$$KhC38CiThimu7PLYZ1xF7",
          "slug" : "ztbk"
        } ],
        "outputs" : [ {
          "id" : "uFQQVVxsclz4Zv20QeSzx$$-4SP7b_Mri4iLVbjTnL6R",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "yLIbrU0HOQUDFBkyMTLhS$$6vhCK9mYxMztJmphVZqUc" : {
      "id" : "yLIbrU0HOQUDFBkyMTLhS$$6vhCK9mYxMztJmphVZqUc",
      "component" : "Source",
      "metadata" : {
        "label" : "zrms_loan_account",
        "x" : -720,
        "y" : 280,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zrms_loan_account",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "xpcGa4_3PNM07hjCnkIq7$$tVdnIOavWthAptI0ZMoxg",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "3wo9kLHphslEy4gvbdEBG$$XSHdJVDMv9aQXT23LD48q" : {
      "id" : "3wo9kLHphslEy4gvbdEBG$$XSHdJVDMv9aQXT23LD48q",
      "component" : "Filter",
      "metadata" : {
        "label" : "account_date_filter",
        "x" : -320,
        "y" : 680,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ "ahwVIn-fFztcuYRfGM2pT$$oCzm5TDKDgc-ewU2W38Gy##znex_From_Date", "ahwVIn-fFztcuYRfGM2pT$$oCzm5TDKDgc-ewU2W38Gy##znex_To_Date" ],
        "condition" : {
          "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN znex_From_Date AND znex_To_Date"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ahwVIn-fFztcuYRfGM2pT$$oCzm5TDKDgc-ewU2W38Gy",
          "slug" : "account_loan_joined_data"
        } ],
        "outputs" : [ {
          "id" : "NOn24doeMnM81PcjfWoGz$$1dtmWYFO3fhQ8U2AYrCGo",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "PRS5XBPnGlortyYU7H22T$$ZYUJ58wuf29oloUdufJ-a" : {
      "id" : "PRS5XBPnGlortyYU7H22T$$ZYUJ58wuf29oloUdufJ-a",
      "component" : "Source",
      "metadata" : {
        "label" : "zwgd_all_acct_m_hist",
        "x" : -720,
        "y" : 960,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zwgd_all_acct_m_hist",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "hMZ_zPlZoYG-87a9xlZzC$$60OxxkgjQh_28UmYJ2S11",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "SPDXE8A568zdkQBgwt0Ww$$H1NdL6Y7ipq30N8nuDPJf" : {
      "id" : "SPDXE8A568zdkQBgwt0Ww$$H1NdL6Y7ipq30N8nuDPJf",
      "component" : "Source",
      "metadata" : {
        "label" : "zrms_account",
        "x" : -720,
        "y" : 420,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zrms_account",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "RTAkoDXxA32WobdUsmAFU$$X9XraXvyQGcqUkO1qM4pL",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    }
  },
  "connections" : [ {
    "id" : "conn_S1kGWxZmHKORciv2U-rft$$yGFtXk0Nh4rPFUW65LKq5_JXi0TzLXxNYauLnBDPERm$$U96JagFdUQG9WEAQuitH4_loan_repayment_type_mapping_JXi0TzLXxNYauLnBDPERm$$U96JagFdUQG9WEAQuitH4",
    "source" : "S1kGWxZmHKORciv2U-rft$$yGFtXk0Nh4rPFUW65LKq5",
    "sourcePort" : "JXi0TzLXxNYauLnBDPERm$$U96JagFdUQG9WEAQuitH4",
    "target" : "loan_repayment_type_mapping_JXi0TzLXxNYauLnBDPERm$$U96JagFdUQG9WEAQuitH4",
    "targetPort" : "input_port_0"
  }, {
    "id" : "waXc4uqY8mZsFNidGXV6L",
    "source" : "mtmjA6pwwBI6rDG3TbD8I$$RG6_TMdKixWlr-bPGgn2r",
    "sourcePort" : "DfZK21BGARu7gAh1DzTF9$$mLiajPv-PeY0JmGfgFFR5",
    "target" : "S1kGWxZmHKORciv2U-rft$$yGFtXk0Nh4rPFUW65LKq5",
    "targetPort" : "jAf7TyndYRocaSbtAWgUg$$_iZOWHFjtZKGNVIV072zg"
  }, {
    "id" : "QjktAQDm4jhlQFd3Bvo3K$$8kfrfn3yvxR-zEYyeaaaC",
    "source" : "Ka1lMAkhSfbnRYtSuko0X$$xV8O6gCAsyjyd_k4j8xpL",
    "sourcePort" : "_F1SF2JkNeFNxFaQK4jtj$$zqN1OAIHV-Ezw3f2IJc09",
    "target" : "mtmjA6pwwBI6rDG3TbD8I$$RG6_TMdKixWlr-bPGgn2r",
    "targetPort" : "LwhqIG7HBh-M_iAnEBg9p$$XVcL8Pu5B56w_h-tSykQJ"
  }, {
    "id" : "dKzlc-gm_T8Zd-wh09_at$$Y5xH_nOtIEYvkdEGg8aZ0",
    "source" : "z2ZzCkr81tI69xfB8uV-0$$pJLKrwEUD2C8gSIE8Fg3x",
    "sourcePort" : "uFQQVVxsclz4Zv20QeSzx$$-4SP7b_Mri4iLVbjTnL6R",
    "target" : "mtmjA6pwwBI6rDG3TbD8I$$RG6_TMdKixWlr-bPGgn2r",
    "targetPort" : "MD3Ct4S2CvJ9DkxuyoOlb$$w_WE4uhAldoT3dfToWO_G"
  }, {
    "id" : "R-XtHwrn0XncDrZXGgW4_",
    "source" : "mm0ck3r2hJylyqxhjtF0A$$bi19BWDBI42mTgLwhPb-T",
    "sourcePort" : "N7IS9YutsJNdVduG2JQqc$$rK1iz--TUSr_v13VUJPWw",
    "target" : "mtmjA6pwwBI6rDG3TbD8I$$RG6_TMdKixWlr-bPGgn2r",
    "targetPort" : "k24S0yrbGH2ub_gmtASn0$$06Qc25QhnLohKYCOgC8Pp"
  }, {
    "id" : "ExCeFRkIB2w8B9rck9B8_",
    "source" : "_HZzro8gcfOsRy2XDFzAH$$lzkQ4Ch1yOHejEra_WYq6",
    "sourcePort" : "NjZnONu-Rfc-Gokhhg4sb$$b34s-9V5xOfk5FAYQ6fRO",
    "target" : "mtmjA6pwwBI6rDG3TbD8I$$RG6_TMdKixWlr-bPGgn2r",
    "targetPort" : "mQ11KxoHVIiK_a7pFaLJK$$UJ_12QXSgzMkCc6D3rvWK"
  }, {
    "id" : "8PUt8etGv2-hEJeM0Shpq",
    "source" : "awLTyUKbvtJs0bVtyQtz5$$j6YScd_TZQIaczBCxC_Xg",
    "sourcePort" : "1q5yRtEH0IfJv5RfkgPzB$$pdNSJJ1KvppNwHHVTBEzq",
    "target" : "mtmjA6pwwBI6rDG3TbD8I$$RG6_TMdKixWlr-bPGgn2r",
    "targetPort" : "WPBqvuYlhkCN41AzqGqqJ$$f_s3yDA9b_pJfDIAAuLcw"
  }, {
    "id" : "_PUs4-QC8OmjK10f7NYQ1",
    "source" : "6gPKv6RlzWqQqXKlley_G$$8ZKARztIHUCW59r1N08Lp",
    "sourcePort" : "1PiVMjgJ1F7opoMyFF5sd$$8BLdm3-kwAjUAjcwpu1xH",
    "target" : "Ka1lMAkhSfbnRYtSuko0X$$xV8O6gCAsyjyd_k4j8xpL",
    "targetPort" : "uDfNqiPP6P7qDNTFYjXYZ$$A7BgJ4d3VZ49Fj_MEYfpi"
  }, {
    "id" : "arBZNsVp3357Mko-_L1gz",
    "source" : "LsYgYhWoyM4L3X4wBFI0u$$2GTSOM0MoHjs8qsb5t0Os",
    "sourcePort" : "C_TsE3dCOpkNOdKLTDeSz$$aAVlLRetqgDoAQGEDoW2C",
    "target" : "z2ZzCkr81tI69xfB8uV-0$$pJLKrwEUD2C8gSIE8Fg3x",
    "targetPort" : "nYFVpLlCPP3skWHr8wKAH$$KhC38CiThimu7PLYZ1xF7"
  }, {
    "id" : "7tS3fJumIN2HXgz6Q2VQU",
    "source" : "jzFgSqX2Pg71yfE6lTWcV$$20Aw6k1bDWYfGm7k5THgb",
    "sourcePort" : "MbNEytxKib9pJhTNLzVPy$$lUI7qTHv-wa_aMd73AGTr",
    "target" : "mm0ck3r2hJylyqxhjtF0A$$bi19BWDBI42mTgLwhPb-T",
    "targetPort" : "dN5JfWSd0ag1XehiP8XF8$$FkuZxXjE30Y_RHIfV8S2W"
  }, {
    "id" : "lxXGReBUQZb3GJXadiw_h",
    "source" : "3wo9kLHphslEy4gvbdEBG$$XSHdJVDMv9aQXT23LD48q",
    "sourcePort" : "NOn24doeMnM81PcjfWoGz$$1dtmWYFO3fhQ8U2AYrCGo",
    "target" : "_HZzro8gcfOsRy2XDFzAH$$lzkQ4Ch1yOHejEra_WYq6",
    "targetPort" : "v9RAnEdjbnLQmcOqdFbOE$$A-gJBLDMJOyx_SksZ9pa0"
  }, {
    "id" : "3rav1ED3WHc-A4gIMdlBW",
    "source" : "WUMNk1vOoP7LjS5RCedUh$$zaJWXVbXi_PY-GaTrHivx",
    "sourcePort" : "2uM_cXdyLdXFbW2gYvCLV$$QJW8Mes334PWL3XVAOA3e",
    "target" : "awLTyUKbvtJs0bVtyQtz5$$j6YScd_TZQIaczBCxC_Xg",
    "targetPort" : "HH9TevrBk18SynDCl5T2l$$VT2iIvsdlb7HahNoxzSrn"
  }, {
    "id" : "OJY6xXaYdZ3DC91K6qBiH",
    "source" : "G42-Yj1KdPshfEaw5dodv$$emnDf7lKhswJmGTFFj5Pz",
    "sourcePort" : "3u9_Xl_rh82_CYcQN-C4L$$ndUMQ5pCfAK-b2wfHw05c",
    "target" : "6gPKv6RlzWqQqXKlley_G$$8ZKARztIHUCW59r1N08Lp",
    "targetPort" : "oXoRTbX0AJcY3tl8nVYvz$$cubb7Ywz-rzr5HprhdfrR"
  }, {
    "id" : "3B9pAH2CFvdg8INcCPZ2y",
    "source" : "gY0QJsI1me5y9TtecxkYA$$VqrFPclpJ6rmCuBfjH9m0",
    "sourcePort" : "JFRDIzOAbbi6myo4lojOp$$zdyaHgHsYKQXqThVsGdP4",
    "target" : "LsYgYhWoyM4L3X4wBFI0u$$2GTSOM0MoHjs8qsb5t0Os",
    "targetPort" : "_rOrGQniITcOlJ216sKSX$$SuKD78kkdFhaoArP1PVb1"
  }, {
    "id" : "_OZXdgCQr6__cuJFm_6gD",
    "source" : "TIcLGwkzq2ANqRW--YSEQ$$koeF0ZrY51k4y1xWekbJb",
    "sourcePort" : "MJGxv1rAs-Tcqlprbp7_A$$ehz6ZZdGs2roFS5iCDJB_",
    "target" : "jzFgSqX2Pg71yfE6lTWcV$$20Aw6k1bDWYfGm7k5THgb",
    "targetPort" : "ULgDyz5HAuW2a0soBoZIX$$Br-dtyfaufkIrjvPz4x17"
  }, {
    "id" : "pVvNQET6sF5tq6izEpT3k",
    "source" : "L-BOcXvly_gw6oofAithx$$HurZpZo4BdwNSVz7766mD",
    "sourcePort" : "OyjZANIHtSEiRHY6WOmD6$$sn5wF4g6urj_SODJH2Efc",
    "target" : "3wo9kLHphslEy4gvbdEBG$$XSHdJVDMv9aQXT23LD48q",
    "targetPort" : "ahwVIn-fFztcuYRfGM2pT$$oCzm5TDKDgc-ewU2W38Gy"
  }, {
    "id" : "cGhZU8J5igLd7LEbdAiuW",
    "source" : "KLBNHqvpq_3oQmdE7t7YQ$$d9iUPN1jhOsfr3zLN5UzU",
    "sourcePort" : "9vyAehvOo23zd2dVH04cH$$Oqz3fEEDXy1VGVcPc5Sev",
    "target" : "WUMNk1vOoP7LjS5RCedUh$$zaJWXVbXi_PY-GaTrHivx",
    "targetPort" : "Ei8gkAScza38ZvGCPWoyy$$6WflcmUol7U0Gte5Twpim"
  }, {
    "id" : "ppYmNNvfG6qnu5dBHRmzB",
    "source" : "2TEma7YuE5DSrp4SXy09r$$m5iBolAmfSmG_cswYk7qj",
    "sourcePort" : "AHO0PyJwA50GIiJ0qVIHh$$8GUH5Yaf0x02ll8hHUTPr",
    "target" : "G42-Yj1KdPshfEaw5dodv$$emnDf7lKhswJmGTFFj5Pz",
    "targetPort" : "CmyWMd9i9oR97H7dAI4_1$$lY5SaY9WY0nD3X81ZYRAG"
  }, {
    "id" : "9Ei1wKTq0lDG0gRboAqZt",
    "source" : "2TEma7YuE5DSrp4SXy09r$$m5iBolAmfSmG_cswYk7qj",
    "sourcePort" : "AHO0PyJwA50GIiJ0qVIHh$$8GUH5Yaf0x02ll8hHUTPr",
    "target" : "G42-Yj1KdPshfEaw5dodv$$emnDf7lKhswJmGTFFj5Pz",
    "targetPort" : "7MIBnsDScPxjvgXvP1GEY$$s9afbwr_gfhVri9V9n4qe"
  }, {
    "id" : "a9jtFn4ZDe3rGfbUSFnnH",
    "source" : "IbX8bwjmzJVwEJNWQ-JQC$$RB73B2sjrHhZwV3FUAlz0",
    "sourcePort" : "8vn_me9n7Qunpvb91O0ER$$DRaAI5Lmzv7XXSbhHqWPk",
    "target" : "G42-Yj1KdPshfEaw5dodv$$emnDf7lKhswJmGTFFj5Pz",
    "targetPort" : "fLU3G_GBI_zVkx9sxJxDj$$Ercnm4TgDapkChhe8DZt_"
  }, {
    "id" : "MJsTDnaDHFoPdAHUch69X",
    "source" : "SPDXE8A568zdkQBgwt0Ww$$H1NdL6Y7ipq30N8nuDPJf",
    "sourcePort" : "RTAkoDXxA32WobdUsmAFU$$X9XraXvyQGcqUkO1qM4pL",
    "target" : "TIcLGwkzq2ANqRW--YSEQ$$koeF0ZrY51k4y1xWekbJb",
    "targetPort" : "ZTABR8ipnGjmuu8FHwUuv$$Tsbn_N7aSMyB64CUCobCD"
  }, {
    "id" : "gbWjWPwSIDEg8YVbSwSvK",
    "source" : "yLIbrU0HOQUDFBkyMTLhS$$6vhCK9mYxMztJmphVZqUc",
    "sourcePort" : "xpcGa4_3PNM07hjCnkIq7$$tVdnIOavWthAptI0ZMoxg",
    "target" : "TIcLGwkzq2ANqRW--YSEQ$$koeF0ZrY51k4y1xWekbJb",
    "targetPort" : "C2cOSFzMCte3HIn_Lissd$$mn6wc411umF-df1DoVRFa"
  }, {
    "id" : "SaR87X9Nucfi3opNj1UzF",
    "source" : "k00GcMHDKXs0zGMQ-wpEL$$ywyTMKjwiFHxXZFztdxfl",
    "sourcePort" : "hJJmw3Cb0iAgCywiXuFAX$$S15xSjd1gaRBHwuE3JjRP",
    "target" : "L-BOcXvly_gw6oofAithx$$HurZpZo4BdwNSVz7766mD",
    "targetPort" : "-qL3Gwh97QcKT_9Ls7YhX$$jFDZHjA5l-PqsAk7x91Gn"
  }, {
    "id" : "e2-zkp9z23OYFQQZoSInk",
    "source" : "2iizAFqOBTeJm2inIQblg$$9BtGc6xFSDN5h7usciTHP",
    "sourcePort" : "2FPvMporvYO1rFJFMWefK$$ndzXIJZaIN8YXePts4QTP",
    "target" : "L-BOcXvly_gw6oofAithx$$HurZpZo4BdwNSVz7766mD",
    "targetPort" : "3FtalKbSsYrw5URGRTt8b$$iiuss3e9NZ_1putx9LzXf"
  }, {
    "id" : "iT-92iEFmPHkaVaK2NpUU",
    "source" : "PRS5XBPnGlortyYU7H22T$$ZYUJ58wuf29oloUdufJ-a",
    "sourcePort" : "hMZ_zPlZoYG-87a9xlZzC$$60OxxkgjQh_28UmYJ2S11",
    "target" : "KLBNHqvpq_3oQmdE7t7YQ$$d9iUPN1jhOsfr3zLN5UzU",
    "targetPort" : "Ijatyp1RFtV6OE4kRSLdu$$sh1mNT9rMLju04Ov3Qg3L"
  }, {
    "id" : "NfcqvHDMz7P7XSNf6ZRA3",
    "source" : "XKdgsr36gbVkJ2_E6o-ci$$1tnBPFYkgvk4B5kbk6Ru_",
    "sourcePort" : "XFeZjPSWV5hRszb_7Q6zm$$IHuZcIczgGGBvqDMKtqrp",
    "target" : "KLBNHqvpq_3oQmdE7t7YQ$$d9iUPN1jhOsfr3zLN5UzU",
    "targetPort" : "4ExQi3_ncpjKuef4ejSnh$$kJtbviHvIPj8Jjx41ow5g"
  } ],
  "component" : "Model"
}