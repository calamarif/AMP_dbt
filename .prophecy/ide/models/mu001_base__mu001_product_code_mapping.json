{
  "id" : "mu001_base__mu001_product_code_mapping",
  "metainfo" : {
    "label" : "mu001_base__mu001_product_code_mapping",
    "autoLayout" : true,
    "staleState" : "none",
    "sourceSuggestions" : {
      "sources" : [ ]
    },
    "graphConfig" : {
      "entityConfig" : {
        "materialized" : "ephemeral",
        "database" : "\"main\"",
        "schema" : "\"default\"",
        "type" : "ModelConfig"
      }
    },
    "version" : 3
  },
  "processes" : {
    "zwgd_mrtg_loan_m##UDphIavK" : {
      "id" : "zwgd_mrtg_loan_m##UDphIavK",
      "component" : "Source",
      "metadata" : {
        "label" : "zwgd_mrtg_loan_m_hist",
        "x" : -1120,
        "y" : -280,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zwgd_mrtg_loan_m_hist",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "m7KkOfAA",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "oxZgz7rNzwsdNxqgXG31D$$Jjy3BcxTVWNvC14K8r_r-" : {
      "id" : "oxZgz7rNzwsdNxqgXG31D$$Jjy3BcxTVWNvC14K8r_r-",
      "component" : "Source",
      "metadata" : {
        "label" : "zwgd_all_acct_m_hist",
        "x" : -1120,
        "y" : -420,
        "phase" : 0
      },
      "properties" : {
        "writeOptions" : {
          "writeMode" : "overwrite"
        },
        "table" : {
          "name" : "zwgd_all_acct_m_hist",
          "sourceName" : "westpac_edw_views",
          "sourceType" : "Table"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "WMyIiGVU",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "mu001_product_code_mapping_C8QZmNmJ" : {
      "id" : "mu001_product_code_mapping_C8QZmNmJ",
      "component" : "TargetModel",
      "metadata" : {
        "label" : "mu001_product_code_mapping"
      },
      "properties" : {
        "customQueryDisabled" : true,
        "customQuery" : false,
        "incrementalEditorDisabled" : true,
        "query" : "\nSELECT *\n\nFROM mu001_product_code_mapping\n\n",
        "isModel" : true,
        "incrementalKey" : false,
        "incremental" : {
          "expression" : "true"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "input_port_0",
          "slug" : "input_port_0"
        } ],
        "outputs" : [ {
          "id" : "output_port_0",
          "slug" : "output_port_0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "mb_accounts_filt##Txek0dRY" : {
      "id" : "mb_accounts_filt##Txek0dRY",
      "component" : "Filter",
      "metadata" : {
        "label" : "mb_accounts_filtered",
        "x" : -720,
        "y" : -350,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "Source_System_Code = 'MB'\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN From_Date AND To_Date"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "tqICfExl",
          "slug" : "account_loan_product_join"
        } ],
        "outputs" : [ {
          "id" : "cQfqUQLg",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "mu001_product_co##DF8LM2uX" : {
      "id" : "mu001_product_co##DF8LM2uX",
      "component" : "Reformat",
      "metadata" : {
        "label" : "mu001_product_code_mapping",
        "x" : -520,
        "y" : -350,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "Armt_Key"
          },
          "alias" : "ARMT_KEY",
          "_row_id" : "1036800087"
        }, {
          "expression" : {
            "expression" : "'MU-001'"
          },
          "alias" : "SRC_SYS_CODE",
          "_row_id" : "640056077"
        }, {
          "expression" : {
            "expression" : "''"
          },
          "alias" : "SRC_REPAY_TYPE_CODE",
          "_row_id" : "883938952"
        }, {
          "expression" : {
            "expression" : "'Product_Code'"
          },
          "alias" : "SRC_COLUMN",
          "_row_id" : "423397447"
        }, {
          "expression" : {
            "expression" : "Product_Code"
          },
          "alias" : "MU001_PRODUCT_CODE",
          "_row_id" : "1583641008"
        }, {
          "expression" : {
            "expression" : "System_Product_Type"
          },
          "alias" : "MU001_SYSTEM_PRODUCT_TYPE",
          "_row_id" : "1938823482"
        }, {
          "expression" : {
            "expression" : "TO_DATE('{{ edw_process_date }}', 'yyyyMMdd')"
          },
          "alias" : "PROCESS_DATE",
          "_row_id" : "1553183921"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "QxDbRikh",
          "slug" : "mb_accounts_filtered"
        } ],
        "outputs" : [ {
          "id" : "C8QZmNmJ",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "account_loan_pro##SQvzwTpo" : {
      "id" : "account_loan_pro##SQvzwTpo",
      "component" : "Join",
      "metadata" : {
        "label" : "account_loan_product_join",
        "x" : -920,
        "y" : -350,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "zwgd_mrtg_loan_m_hist",
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.Account_Id = zwgd_mrtg_loan_m_hist.Account_Id\nAND TO_DATE('{{ edw_process_date }}', 'yyyyMMdd') BETWEEN zwgd_mrtg_loan_m_hist.From_Date AND zwgd_mrtg_loan_m_hist.To_Date"
          },
          "joinType" : "LEFT"
        } ],
        "expressions" : [ {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.Armt_Key"
          },
          "_row_id" : "92491133"
        }, {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.Source_System_Code"
          },
          "_row_id" : "145751963"
        }, {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.From_Date"
          },
          "_row_id" : "1019258764"
        }, {
          "expression" : {
            "expression" : "zwgd_all_acct_m_hist.To_Date"
          },
          "_row_id" : "222908693"
        }, {
          "expression" : {
            "expression" : "zwgd_mrtg_loan_m_hist.Product_Code"
          },
          "_row_id" : "218261438"
        }, {
          "expression" : {
            "expression" : "zwgd_mrtg_loan_m_hist.System_Product_Type"
          },
          "_row_id" : "1938717808"
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "headAlias" : "zwgd_all_acct_m_hist"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "FSGL2XHd",
          "slug" : "zwgd_all_acct_m_hist"
        }, {
          "id" : "EW58qwO1",
          "slug" : "zwgd_mrtg_loan_m_hist"
        } ],
        "outputs" : [ {
          "id" : "aVl2EJqO",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    }
  },
  "connections" : [ {
    "id" : "conn_mu001_product_co##DF8LM2uX_C8QZmNmJ_mu001_product_code_mapping_C8QZmNmJ",
    "source" : "mu001_product_co##DF8LM2uX",
    "sourcePort" : "C8QZmNmJ",
    "target" : "mu001_product_code_mapping_C8QZmNmJ",
    "targetPort" : "input_port_0"
  }, {
    "id" : "VatkDbE5",
    "source" : "mb_accounts_filt##Txek0dRY",
    "sourcePort" : "cQfqUQLg",
    "target" : "mu001_product_co##DF8LM2uX",
    "targetPort" : "QxDbRikh"
  }, {
    "id" : "HjSzpAJL",
    "source" : "account_loan_pro##SQvzwTpo",
    "sourcePort" : "aVl2EJqO",
    "target" : "mb_accounts_filt##Txek0dRY",
    "targetPort" : "tqICfExl"
  }, {
    "id" : "J3q6UZl9",
    "source" : "oxZgz7rNzwsdNxqgXG31D$$Jjy3BcxTVWNvC14K8r_r-",
    "sourcePort" : "WMyIiGVU",
    "target" : "account_loan_pro##SQvzwTpo",
    "targetPort" : "FSGL2XHd"
  }, {
    "id" : "dn6oG4lT",
    "source" : "zwgd_mrtg_loan_m##UDphIavK",
    "sourcePort" : "m7KkOfAA",
    "target" : "account_loan_pro##SQvzwTpo",
    "targetPort" : "EW58qwO1"
  } ],
  "component" : "Model"
}